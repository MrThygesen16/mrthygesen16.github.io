<!DOCTYPE html>
<html lang="en">
<head><meta charset="utf-8">
<title>Secure Environment Variable Injection using AzAPI &amp; AzureRM</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta property="og:image">
<meta name="twitter:card" content="summary_large_image">
<meta property="og:title" content="Secure Environment Variable Injection using AzAPI & AzureRM">
<meta name="description" content="2025/08/05">
<meta property="og:description" content="2025/08/05"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/entry.fbbe5afd.js"><link rel="preload" as="style" href="/_nuxt/entry.b2c8c71d.css"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/document-driven.87df1944.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/DocumentDrivenEmpty.fee45ee8.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ContentRenderer.de905a67.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ContentRendererMarkdown.26313063.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/DocumentDrivenNotFound.71d8b221.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/head.73d3986a.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/full-width.4f22855b.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseHr.3308741e.js"><link rel="preload" as="style" href="/_nuxt/ProseHr.1cdf549c.css"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseH1.bd68c467.js"><link rel="preload" as="style" href="/_nuxt/ProseH1.88370863.css"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseP.208988c6.js"><link rel="preload" as="style" href="/_nuxt/ProseP.05611450.css"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseH2.07fc7dc7.js"><link rel="preload" as="style" href="/_nuxt/ProseH2.2119cb0f.css"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseA.a8aa2b86.js"><link rel="preload" as="style" href="/_nuxt/ProseA.2842c197.css"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseBlockquote.24a33847.js"><link rel="preload" as="style" href="/_nuxt/ProseBlockquote.7f2b4622.css"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseStrong.81b8e75d.js"><link rel="preload" as="style" href="/_nuxt/ProseStrong.9e61c61f.css"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseOl.855d8e97.js"><link rel="preload" as="style" href="/_nuxt/ProseOl.283d6fa8.css"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseLi.f07ee995.js"><link rel="preload" as="style" href="/_nuxt/ProseLi.b91c4a22.css"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseCode.a0aea765.js"><link rel="preload" as="style" href="/_nuxt/ProseCode.f723dbd6.css"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/index.a42693c5.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseCodeInline.424395a6.js"><link rel="preload" as="style" href="/_nuxt/ProseCodeInline.18e52e56.css"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseTable.04181e31.js"><link rel="preload" as="style" href="/_nuxt/ProseTable.b652fe84.css"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseThead.a8566545.js"><link rel="preload" as="style" href="/_nuxt/ProseThead.b93fb938.css"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseTr.ba3a0022.js"><link rel="preload" as="style" href="/_nuxt/ProseTr.59c44cd9.css"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseTh.455bb0b8.js"><link rel="preload" as="style" href="/_nuxt/ProseTh.abf500a3.css"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseTbody.60d719e7.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseTd.ac017cd2.js"><link rel="preload" as="style" href="/_nuxt/ProseTd.8ee8d87a.css"><link rel="prefetch" as="script" crossorigin href="/_nuxt/default.f9efc930.js"><link rel="prefetch" as="script" crossorigin href="/_nuxt/debug.89ca14f3.js"><link rel="prefetch" as="style" href="/_nuxt/useStudio.2e4ff8be.css"><link rel="prefetch" as="script" crossorigin href="/_nuxt/useStudio.b971ca3d.js"><link rel="prefetch" as="script" crossorigin href="/_nuxt/asyncData.c09499e9.js"><link rel="prefetch" as="script" crossorigin href="/_nuxt/client-db.824bb3e1.js"><link rel="prefetch" as="style" href="/_nuxt/error-404.97011ca1.css"><link rel="prefetch" as="script" crossorigin href="/_nuxt/error-404.a7819ffe.js"><link rel="prefetch" as="style" href="/_nuxt/error-500.82e14f63.css"><link rel="prefetch" as="script" crossorigin href="/_nuxt/error-500.c3688185.js"><style id="pinceau-theme">@media { :root {--pinceau-mq: initial; --elements-modal-scrim-backdropFilter: none;--elements-modal-zIndex: 50;--elements-sandbox-borderStyle: solid;--elements-sandbox-borderWidth: 1px;--elements-sandbox-height: 700px;--elements-list-item-icon-boxShadow: inset 0.25px 0.5px 0px hsla(0,0%,100%,.1), inset -0.25px 0px 0px hsla(0,0%,100%,.1);--elements-list-item-lastChild-marginBottom: 0px;--elements-tooltip-content-borderStyle: none;--elements-tooltip-content-borderWidth: 0px;--elements-disclosure-opened-summary-transform: rotate(0deg);--elements-disclosure-opened-summary-borderBottomRightRadius: 0px;--elements-disclosure-opened-summary-borderBottomLeftRadius: 0px;--elements-disclosure-content-borderColor: transparent;--elements-disclosure-content-borderStyle: solid;--elements-disclosure-content-borderWidth: 1px;--elements-disclosure-content-lastChild-marginBottom: 0px;--elements-disclosure-content-firstChild-marginTop: 0px;--elements-disclosure-content-padding: 1rem;--elements-disclosure-summary-chevron-transform: rotate(-90deg);--elements-disclosure-summary-chevron-transition: transform 200ms ease-in-out;--elements-disclosure-summary-chevron-padding: 2px;--elements-disclosure-summary-outline-focus: 2px solid;--elements-disclosure-summary-padding: 1rem;--elements-disclosure-borderStyle: solid;--elements-disclosure-borderWidth: 0px;--elements-disclosure-width: 100%;--elements-callout-content-lastChild-marginBottom: 0px;--elements-callout-content-firstChild-marginTop: 0px;--elements-callout-boxShadow: inset 0.25px 0.5px 0px hsla(0,0%,100%,.1), inset -0.25px 0px 0px hsla(0,0%,100%,.1);--elements-callout-borderStyle: solid;--elements-callout-borderWidth: 1px;--elements-callout-width: 100%;--elements-codeGroup-tabs-active-borderBlockEnd: 1px solid transparent;--elements-codeGroup-tabs-inactive-filter-hover: grayscale(0%);--elements-codeGroup-tabs-inactive-filter-static: grayscale(100%);--elements-codeGroup-tabs-lastOfType-border: none;--elements-codeGroup-tabs-firstOfType-border: none;--elements-codeGroup-tabs-textAlign: start;--elements-codeGroup-tabs-flex: 1;--elements-codeGroup-borderStyle: solid;--elements-codeGroup-borderWidth: 1px;--elements-codeGroup-margin: 0px;--elements-codeCollapse-gradientBackdrop-height: 50px;--elements-codeCollapse-button-borderStyle: solid;--elements-codeCollapse-button-borderWidth: 1px;--elements-codeCollapse-button-transform: translateX(-50%);--elements-codeCollapse-button-left: 50%;--elements-buttonLink-width: fit-content;--elements-buttonLink-boxShadow: inset 0.25px 0.5px 0px hsla(0,0%,100%,.1), inset -0.25px 0px 0px hsla(0,0%,100%,.1);--elements-buttonLink-borderColor: transparent;--elements-buttonLink-borderStyle: solid;--elements-buttonLink-borderWidth: 0px;--elements-badge-whiteSpace: nowrap;--elements-badge-boxShadow: inset 0.25px 0.5px 0px hsla(0,0%,100%,.1), inset -0.25px 0px 0px hsla(0,0%,100%,.1);--elements-badge-borderStyle: solid;--elements-badge-borderWidth: 1px;--elements-alert-closeButton-boxShadow-focus: 0 0 0 1px;--elements-alert-boxShadow: inset 0.25px 0.5px 0px hsla(0,0%,100%,.1), inset -0.25px 0px 0px hsla(0,0%,100%,.1);--elements-alert-borderStyle: solid;--elements-alert-borderWidth: 1px;--elements-alert-width: 100%;--elements-announce-boxShadow: inset 0.5px 0.75px 0px hsla(0,0%,100%,.1), inset -0.5px 0px 0px hsla(0,0%,100%,.1);--elements-announce-borderStyle: solid;--elements-announce-borderWidth: 1px;--elements-border-secondary-hover: [object Object];--elements-backdrop-background: #fffc;--elements-backdrop-filter: saturate(200%) blur(10px);--test: 0px;--prose-code-inline-padding: 0.2rem 0.375rem 0.2rem 0.375rem;--prose-code-block-backdropFilter: contrast(1);--prose-code-block-borderStyle: solid;--prose-code-block-borderWidth: 1px;--prose-tbody-tr-borderBottom-style: dashed;--prose-tbody-tr-borderBottom-width: 1px;--prose-th-textAlign: inherit;--prose-thead-borderBottom-style: solid;--prose-thead-borderBottom-width: 1px;--prose-thead-border-style: solid;--prose-thead-border-width: 0px;--prose-table-textAlign: start;--prose-hr-width: 1px;--prose-hr-style: solid;--prose-li-listStylePosition: outside;--prose-ol-li-markerColor: currentColor;--prose-ol-paddingInlineStart: 21px;--prose-ol-listStyleType: decimal;--prose-ul-li-markerColor: currentColor;--prose-ul-paddingInlineStart: 21px;--prose-ul-listStyleType: disc;--prose-blockquote-border-style: solid;--prose-blockquote-border-width: 4px;--prose-blockquote-quotes: '201C' '201D' '2018' '2019';--prose-blockquote-paddingInlineStart: 24px;--prose-a-code-color-hover: currentColor;--prose-a-hasCode-borderBottom: none;--prose-a-border-distance: 2px;--prose-a-border-color-hover: currentColor;--prose-a-border-color-static: currentColor;--prose-a-border-style-hover: solid;--prose-a-border-style-static: dashed;--prose-a-border-width: 1px;--prose-a-color-static: inherit;--prose-a-textDecoration: none;--prose-h6-margin: 3rem 0 2rem;--prose-h5-margin: 3rem 0 2rem;--prose-h4-margin: 3rem 0 2rem;--prose-h3-margin: 3rem 0 2rem;--prose-h2-margin: 3rem 0 2rem;--prose-h1-margin: 0 0 2rem;--typography-radii-full: 9999px;--typography-radii-6xl: 32px;--typography-radii-5xl: 28px;--typography-radii-4xl: 24px;--typography-radii-3xl: 20px;--typography-radii-2xl: 18px;--typography-radii-xl: 16px;--typography-radii-lg: 14px;--typography-radii-md: 12px;--typography-radii-sm: 10px;--typography-radii-xs: 8px;--typography-radii-2xs: 6px;--typography-radii-3xs: 4px;--typography-radii-4xs: 2px;--typography-radii-none: 0px;--typography-color-secondary-900: #121110;--typography-color-secondary-800: #201E1B;--typography-color-secondary-700: #36332E;--typography-color-secondary-600: #67635D;--typography-color-secondary-500: #97948F;--typography-color-secondary-400: #ADA9A4;--typography-color-secondary-300: #DBD9D3;--typography-color-secondary-200: #ECEBE8;--typography-color-secondary-100: #F6F5F4;--typography-color-secondary-50: #FBFBFB;--typography-color-primary-900: #001238;--typography-color-primary-800: #002370;--typography-color-primary-700: #0035a9;--typography-color-primary-600: #0047e1;--typography-color-primary-500: #1a62ff;--typography-color-primary-400: #407cff;--typography-color-primary-300: #6696ff;--typography-color-primary-200: #8db0ff;--typography-color-primary-100: #b3cbff;--typography-color-primary-50: #d9e5ff;--typography-color-black: #0E0D0D;--typography-color-white: #ffffff;--typography-font-mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, Liberation Mono, Courier New, monospace;--typography-font-serif: ui-serif, Georgia, Cambria, Times New Roman, Times, serif;--typography-font-sans: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica Neue, Arial, Noto Sans, sans-serif, Apple Color Emoji, Segoe UI Emoji, Segoe UI Symbol, Noto Color Emoji;--typography-lead-loose: 2;--typography-lead-relaxed: 1.625;--typography-lead-normal: 1.5;--typography-lead-snug: 1.375;--typography-lead-tight: 1.25;--typography-lead-none: 1;--typography-lead-10: 2.5rem;--typography-lead-9: 2.25rem;--typography-lead-8: 2rem;--typography-lead-7: 1.75rem;--typography-lead-6: 1.5rem;--typography-lead-5: 1.25rem;--typography-lead-4: 1rem;--typography-lead-3: .75rem;--typography-lead-2: .5rem;--typography-lead-1: .025rem;--typography-fontWeight-black: 900;--typography-fontWeight-extrabold: 800;--typography-fontWeight-bold: 700;--typography-fontWeight-semibold: 600;--typography-fontWeight-medium: 500;--typography-fontWeight-normal: 400;--typography-fontWeight-light: 300;--typography-fontWeight-extralight: 200;--typography-fontWeight-thin: 100;--typography-fontSize-9xl: 128px;--typography-fontSize-8xl: 96px;--typography-fontSize-7xl: 72px;--typography-fontSize-6xl: 60px;--typography-fontSize-5xl: 48px;--typography-fontSize-4xl: 36px;--typography-fontSize-3xl: 30px;--typography-fontSize-2xl: 24px;--typography-fontSize-xl: 20px;--typography-fontSize-lg: 18px;--typography-fontSize-base: 16px;--typography-fontSize-sm: 14px;--typography-fontSize-xs: 12px;--typography-letterSpacing-widest: 0.08em;--typography-letterSpacing-wider: 0.04em;--typography-letterSpacing-wide: 0.02em;--typography-letterSpacing-normal: 0em;--typography-letterSpacing-tight: -0.02em;--typography-letterSpacing-tighter: -0.04em;--typography-verticalMargin-base: 24px;--typography-verticalMargin-sm: 16px;--ease-back-inOut: cubic-bezier(0.68, -0.6, 0.32, 1.6);--ease-back-out: cubic-bezier(0.34, 1.56, 0.64, 1);--ease-back-in: cubic-bezier(0.36, 0, 0.66, -0.56);--ease-circ-inOut: cubic-bezier(0.85, 0, 0.15, 1);--ease-circ-out: cubic-bezier(0, 0.55, 0.45, 1);--ease-circ-in: cubic-bezier(0.55, 0, 1, 0.45);--ease-expo-inOut: cubic-bezier(0.87, 0, 0.13, 1);--ease-expo-out: cubic-bezier(0.16, 1, 0.3, 1);--ease-expo-in: cubic-bezier(0.7, 0, 0.84, 0);--ease-quint-inOut: cubic-bezier(0.83, 0, 0.17, 1);--ease-quint-out: cubic-bezier(0.22, 1, 0.36, 1);--ease-quint-in: cubic-bezier(0.64, 0, 0.78, 0);--ease-quart-inOut: cubic-bezier(0.76, 0, 0.24, 1);--ease-quart-out: cubic-bezier(0.25, 1, 0.5, 1);--ease-quart-in: cubic-bezier(0.5, 0, 0.75, 0);--ease-cubic-inOut: cubic-bezier(0.65, 0, 0.35, 1);--ease-cubic-out: cubic-bezier(0.33, 1, 0.68, 1);--ease-cubic-in: cubic-bezier(0.32, 0, 0.67, 0);--ease-quad-inOut: cubic-bezier(0.45, 0, 0.55, 1);--ease-quad-out: cubic-bezier(0.5, 1, 0.89, 1);--ease-quad-in: cubic-bezier(0.11, 0, 0.5, 0);--ease-sine-inOut: cubic-bezier(0.37, 0, 0.63, 1);--ease-sine-out: cubic-bezier(0.61, 1, 0.88, 1);--ease-sine-in: cubic-bezier(0.12, 0, 0.39, 0);--ease-default-inOut: cubic-bezier(0.4, 0, 0.2, 1);--ease-default-out: cubic-bezier(0, 0, 0.2, 1);--ease-default-in: cubic-bezier(0.4, 0, 1, 1);--ease-linear: cubic-bezier(0, 0, 1, 1);--lead-loose: 2;--lead-relaxed: 1.625;--lead-normal: 1.5;--lead-snug: 1.375;--lead-tight: 1.25;--lead-none: 1;--lead-10: 2.5rem;--lead-9: 2.25rem;--lead-8: 2rem;--lead-7: 1.75rem;--lead-6: 1.5rem;--lead-5: 1.25rem;--lead-4: 1rem;--lead-3: .75rem;--lead-2: .5rem;--lead-1: .025rem;--letterSpacing-widest: 0.08em;--letterSpacing-wider: 0.04em;--letterSpacing-wide: 0.02em;--letterSpacing-normal: 0em;--letterSpacing-tight: -0.02em;--letterSpacing-tighter: -0.04em;--fontSize-9xl: 8rem;--fontSize-8xl: 6rem;--fontSize-7xl: 4.5rem;--fontSize-6xl: 3.75rem;--fontSize-5xl: 3rem;--fontSize-4xl: 2.25rem;--fontSize-3xl: 1.875rem;--fontSize-2xl: 1.5rem;--fontSize-xl: 1.25rem;--fontSize-lg: 1.125rem;--fontSize-base: 1rem;--fontSize-sm: 0.875rem;--fontSize-xs: 0.75rem;--fontWeight-black: 900;--fontWeight-extrabold: 800;--fontWeight-bold: 700;--fontWeight-semibold: 600;--fontWeight-medium: 500;--fontWeight-normal: 400;--fontWeight-light: 300;--fontWeight-extralight: 200;--fontWeight-thin: 100;--font-mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, Liberation Mono, Courier New, monospace;--font-serif: ui-serif, Georgia, Cambria, Times New Roman, Times, serif;--font-sans: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica Neue, Arial, Noto Sans, sans-serif, Apple Color Emoji, Segoe UI Emoji, Segoe UI Symbol, Noto Color Emoji;--opacity-total: 1;--opacity-high: 0.8;--opacity-medium: 0.5;--opacity-soft: 0.3;--opacity-light: 0.15;--opacity-bright: 0.1;--opacity-noOpacity: 0;--borderWidth-lg: 3px;--borderWidth-md: 2px;--borderWidth-sm: 1px;--borderWidth-noBorder: 0;--space-rem-875: 0.875rem;--space-rem-625: 0.625rem;--space-rem-375: 0.375rem;--space-rem-125: 0.125rem;--space-px: 1px;--space-128: 32rem;--space-96: 24rem;--space-80: 20rem;--space-72: 18rem;--space-64: 16rem;--space-60: 15rem;--space-56: 14rem;--space-52: 13rem;--space-48: 12rem;--space-44: 11rem;--space-40: 10rem;--space-36: 9rem;--space-32: 8rem;--space-28: 7rem;--space-24: 6rem;--space-20: 5rem;--space-16: 4rem;--space-14: 3.5rem;--space-12: 3rem;--space-11: 2.75rem;--space-10: 2.5rem;--space-9: 2.25rem;--space-8: 2rem;--space-7: 1.75rem;--space-6: 1.5rem;--space-5: 1.25rem;--space-4: 1rem;--space-3: 0.75rem;--space-2: 0.5rem;--space-1: 0.25rem;--space-0: 0px;--size-full: 100%;--size-7xl: 80rem;--size-6xl: 72rem;--size-5xl: 64rem;--size-4xl: 56rem;--size-3xl: 48rem;--size-2xl: 42rem;--size-xl: 36rem;--size-lg: 32rem;--size-md: 28rem;--size-sm: 24rem;--size-xs: 20rem;--size-200: 200px;--size-104: 104px;--size-80: 80px;--size-64: 64px;--size-56: 56px;--size-48: 48px;--size-40: 40px;--size-32: 32px;--size-24: 24px;--size-20: 20px;--size-16: 16px;--size-12: 12px;--size-8: 8px;--size-6: 6px;--size-4: 4px;--size-2: 2px;--size-0: 0px;--radii-full: 9999px;--radii-6xl: 32px;--radii-5xl: 28px;--radii-4xl: 24px;--radii-3xl: 20px;--radii-2xl: 18px;--radii-xl: 16px;--radii-lg: 14px;--radii-md: 12px;--radii-sm: 10px;--radii-xs: 8px;--radii-2xs: 6px;--radii-3xs: 4px;--radii-4xs: 2px;--radii-none: 0px;--shadow-none: 0px 0px 0px 0px transparent;--shadow-lg: 0px 10px 15px -3px #000000, 0px 4px 6px -4px #000000;--shadow-md: 0px 4px 6px -1px #000000, 0px 2px 4px -2px #000000;--shadow-sm: 0px 1px 3px 0px #000000, 0px 1px 2px -1px #000000;--shadow-xs: 0px 1px 2px 0px #000000;--height-screen: 100vh;--width-screen: 100vw;--color-secondary-950: #030712;--color-secondary-900: #111827;--color-secondary-800: #1f2937;--color-secondary-700: #374151;--color-secondary-600: #4b5563;--color-secondary-500: #6b7280;--color-secondary-400: #9ca3af;--color-secondary-300: #d1d5db;--color-secondary-200: #e5e7eb;--color-secondary-100: #f3f4f6;--color-secondary-50: #f9fafb;--color-primary-950: #042f2e;--color-primary-900: #134e4a;--color-primary-800: #115e59;--color-primary-700: #0f766e;--color-primary-600: #0d9488;--color-primary-500: #14b8a6;--color-primary-400: #2dd4bf;--color-primary-300: #5eead4;--color-primary-200: #99f6e4;--color-primary-100: #ccfbf1;--color-primary-50: #f0fdfa;--color-ruby-900: #380011;--color-ruby-800: #700021;--color-ruby-700: #a90032;--color-ruby-600: #e10043;--color-ruby-500: #ff1a5e;--color-ruby-400: #ff4079;--color-ruby-300: #ff6694;--color-ruby-200: #ff8dae;--color-ruby-100: #ffb3c9;--color-ruby-50: #ffd9e4;--color-pink-900: #380025;--color-pink-800: #70004b;--color-pink-700: #a90070;--color-pink-600: #e10095;--color-pink-500: #ff1ab2;--color-pink-400: #ff40bf;--color-pink-300: #ff66cc;--color-pink-200: #ff8dd8;--color-pink-100: #ffb3e5;--color-pink-50: #ffd9f2;--color-purple-900: #080020;--color-purple-800: #14014A;--color-purple-700: #200273;--color-purple-600: #370DAD;--color-purple-500: #6B39FA;--color-purple-400: #8961FD;--color-purple-300: #A589F9;--color-purple-200: #E5DCFF;--color-purple-100: #F1ECFF;--color-purple-50: #F8F5FF;--color-violet-900: #190038;--color-violet-800: #330070;--color-violet-700: #4c00a9;--color-violet-600: #6500e1;--color-violet-500: #811aff;--color-violet-400: #9640ff;--color-violet-300: #ab66ff;--color-violet-200: #c08dff;--color-violet-100: #d5b3ff;--color-violet-50: #ead9ff;--color-royalblue-900: #0b0531;--color-royalblue-800: #160a62;--color-royalblue-700: #211093;--color-royalblue-600: #2c15c4;--color-royalblue-500: #4127e8;--color-royalblue-400: #614bec;--color-royalblue-300: #806ff0;--color-royalblue-200: #a093f3;--color-royalblue-100: #c0b7f7;--color-royalblue-50: #dfdbfb;--color-indigoblue-900: #001238;--color-indigoblue-800: #002370;--color-indigoblue-700: #0035a9;--color-indigoblue-600: #0047e1;--color-indigoblue-500: #1a62ff;--color-indigoblue-400: #407cff;--color-indigoblue-300: #6696ff;--color-indigoblue-200: #8db0ff;--color-indigoblue-100: #b3cbff;--color-indigoblue-50: #d9e5ff;--color-blue-900: #00131D;--color-blue-800: #002235;--color-blue-700: #013858;--color-blue-600: #01659E;--color-blue-500: #1AADFF;--color-blue-400: #64C7FF;--color-blue-300: #A1DDFF;--color-blue-200: #D0EEFF;--color-blue-100: #E2F4FF;--color-blue-50: #F2FAFF;--color-lightblue-900: #001A1F;--color-lightblue-800: #00232B;--color-lightblue-700: #013858;--color-lightblue-600: #0893B1;--color-lightblue-500: #1AD6FF;--color-lightblue-400: #55E1FF;--color-lightblue-300: #82E3FF;--color-lightblue-200: #C5F2FF;--color-lightblue-100: #DCF7FF;--color-lightblue-50: #F1FCFF;--color-teal-900: #062a28;--color-teal-800: #0b544f;--color-teal-700: #117d77;--color-teal-600: #16a79e;--color-teal-500: #1cd1c6;--color-teal-400: #36e4da;--color-teal-300: #5fe9e1;--color-teal-200: #87efe9;--color-teal-100: #aff4f0;--color-teal-50: #d7faf8;--color-pear-900: #2a2b09;--color-pear-800: #545512;--color-pear-700: #7e801b;--color-pear-600: #a8aa24;--color-pear-500: #d0d32f;--color-pear-400: #d8da52;--color-pear-300: #e0e274;--color-pear-200: #e8e997;--color-pear-100: #eff0ba;--color-pear-50: #f7f8dc;--color-red-900: #1C0301;--color-red-800: #340A01;--color-red-700: #550F00;--color-red-600: #AD2203;--color-red-500: #FF3B10;--color-red-400: #FF7353;--color-red-300: #FFA692;--color-red-200: #FFE6E1;--color-red-100: #FFF0EC;--color-red-50: #FFF9F8;--color-pumpkin-900: #381800;--color-pumpkin-800: #702f00;--color-pumpkin-700: #a94700;--color-pumpkin-600: #e15e00;--color-pumpkin-500: #ff7a1a;--color-pumpkin-400: #ff9040;--color-pumpkin-300: #ffa666;--color-pumpkin-200: #ffbd8d;--color-pumpkin-100: #ffd3b3;--color-pumpkin-50: #ffe9d9;--color-orange-900: #1A0A01;--color-orange-800: #2D1102;--color-orange-700: #3F1802;--color-orange-600: #7E3004;--color-orange-500: #FA630E;--color-orange-400: #FC8E51;--color-orange-300: #FDAC7E;--color-orange-200: #FFE5D7;--color-orange-100: #FFEFE5;--color-orange-50: #FFF7F2;--color-yellow-900: #1B1500;--color-yellow-800: #292100;--color-yellow-700: #463801;--color-yellow-600: #AB8A07;--color-yellow-500: #FBCA05;--color-yellow-400: #FFDC4E;--color-yellow-300: #FFE372;--color-yellow-200: #FFF3C0;--color-yellow-100: #FFF7D9;--color-yellow-50: #FFFCEE;--color-green-900: #00190F;--color-green-800: #002817;--color-green-700: #01492C;--color-green-600: #039B5A;--color-green-500: #0DD885;--color-green-400: #3CEEA5;--color-green-300: #86FBCB;--color-green-200: #C0FFE4;--color-green-100: #DBFFF0;--color-green-50: #ECFFF7;--color-gray-900: #121110;--color-gray-800: #1C1B19;--color-gray-700: #292724;--color-gray-600: #3D3B38;--color-gray-500: #97948F;--color-gray-400: #ADA9A4;--color-gray-300: #DBD9D3;--color-gray-200: #ECEBE8;--color-gray-100: #F3F3F2;--color-gray-50: #FBFBFB;--color-black: #0E0D0D;--color-white: #ffffff;--media-portrait: only screen and (orientation: portrait);--media-landscape: only screen and (orientation: landscape);--media-rm: (prefers-reduced-motion: reduce);--media-2xl: (min-width: 1536px);--media-xl: (min-width: 1280px);--media-lg: (min-width: 1024px);--media-md: (min-width: 768px);--media-sm: (min-width: 640px);--media-xs: (min-width: 475px);--elements-drawer-maxWidth: var(--size-xs);--elements-modal-scrim-backgroundColor: var(--color-gray-50);--elements-videoPlayer-borderRadius: var(--radii-sm);--elements-videoPlayer-backgroundColor: var(--color-gray-900);--elements-videoPlayer-marginY: var(--space-8);--elements-sandbox-borderRadius: var(--radii-md);--elements-list-item-icon-height: var(--space-4);--elements-list-item-icon-width: var(--space-4);--elements-list-item-icon-borderRadius: var(--radii-full);--elements-list-item-icon-padding: var(--space-1);--elements-list-item-icon-marginInlineEnd: var(--space-3);--elements-list-item-marginBottom: var(--space-3);--elements-tooltip-content-padding: var(--space-3) var(--space-4);--elements-tooltip-content-borderColor: transparent;--elements-tooltip-content-fontWeight: var(--typography-fontWeight-normal);--elements-tooltip-content-color: var(--color-gray-100);--elements-tooltip-content-backgroundColor: var(--color-gray-700);--elements-tooltip-trigger-outline-focusVisible: 2px solid var(--color-primary-500);--elements-disclosure-content-verticalMargin: var(--typography-verticalMargin-sm);--elements-disclosure-summary-chevron-height: var(--space-5);--elements-disclosure-summary-chevron-width: var(--space-5);--elements-disclosure-summary-icon-marginInlineEnd: var(--space-3);--elements-disclosure-summary-icon-height: var(--space-6);--elements-disclosure-summary-icon-width: var(--space-6);--elements-disclosure-borderRadius: var(--radii-none);--elements-callout-content-verticalMargin: var(--typography-verticalMargin-sm);--elements-callout-title-marginBottom: var(--space-1);--elements-callout-title-fontWeight: var(--fontWeight-medium);--elements-callout-icon-marginInlineEnd: var(--space-3);--elements-callout-icon-height: var(--space-7);--elements-callout-icon-width: var(--space-6);--elements-callout-paddingY: var(--space-4);--elements-callout-paddingX: var(--space-4);--elements-codePreview-padding: var(--space-4);--elements-codePreview-gap: var(--space-4);--elements-codeGroup-tabs-active-backgroundColor: var(--color-gray-50);--elements-codeGroup-tabs-active-color: var(--color-gray-900);--elements-codeGroup-tabs-inactive-backgroundColor: var(--color-gray-100);--elements-codeGroup-tabs-inactive-color-hover: var(--color-gray-900);--elements-codeGroup-tabs-inactive-color-static: var(--color-gray-500);--elements-codeGroup-tabs-icon-size: var(--space-4);--elements-codeGroup-tabs-icon-marginInlineEnd: var(--space-2);--elements-codeGroup-tabs-letterSpacing: var(--letterSpacing-tight);--elements-codeGroup-tabs-fontFamily: var(--font-mono);--elements-codeGroup-tabs-paddingX: var(--space-4);--elements-codeGroup-tabs-paddingY: var(--space-2);--elements-codeCollapse-button-backgroundColor: var(--color-gray-50);--elements-codeCollapse-button-paddingX: var(--space-3);--elements-codeCollapse-button-paddingY: var(--space-1);--elements-codeCollapse-button-bottom: var(--space-2);--elements-codeCollapse-borderStyle: var(--prose-code-block-borderStyle);--elements-codeCollapse-borderWidth: var(--prose-code-block-borderWidth);--elements-buttonLink-giant-padding: var(--space-3) var(--space-5);--elements-buttonLink-large-padding: var(--space-2) var(--space-4);--elements-buttonLink-medium-padding: var(--space-2) var(--space-4);--elements-buttonLink-small-padding: var(--space-1) var(--space-3);--elements-buttonLink-icon-marginInlineEnd: var(--space-2);--elements-buttonLink-borderRadius: var(--radii-2xs);--elements-buttonLink-fontWeight: var(--fontWeight-semibold);--elements-badge-letterSpacing: var(--letterSpacing-tight);--elements-badge-lineHeight: var(--typography-lead-none);--elements-badge-fontWeight: var(--fontWeight-normal);--elements-badge-paddingY: var(--space-1);--elements-badge-paddingX: var(--space-2);--elements-alert-closeButton-icon-height: var(--space-4);--elements-alert-closeButton-icon-width: var(--space-4);--elements-alert-closeButton-marginInlineStart: var(--space-2);--elements-alert-closeButton-padding: var(--space-1);--elements-alert-icon-marginInlineEnd: var(--space-3);--elements-alert-icon-height: var(--space-6);--elements-alert-icon-width: var(--space-6);--elements-alert-paddingY: var(--space-4);--elements-alert-paddingX: var(--space-4);--elements-announce-icon-backgroundColor: var(--color-gray-200);--elements-announce-icon-borderRadius: var(--radii-full);--elements-announce-icon-padding: var(--space-1) var(--space-2);--elements-announce-content-paddingX: var(--space-3);--elements-announce-fontWeight: var(--fontWeight-medium);--elements-announce-borderRadius: var(--radii-full);--elements-announce-backgroundColor: var(--color-gray-100);--elements-announce-padding: var(--space-1);--elements-state-danger-borderColor-secondary: var(--color-red-200);--elements-state-danger-borderColor-primary: var(--color-red-100);--elements-state-danger-backgroundColor-tertiary: var(--color-red-200);--elements-state-danger-backgroundColor-secondary: var(--color-red-100);--elements-state-danger-backgroundColor-primary: var(--color-red-50);--elements-state-danger-color-tertiary: var(--color-red-700);--elements-state-danger-color-secondary: var(--color-red-600);--elements-state-danger-color-primary: var(--color-red-500);--elements-state-warning-borderColor-secondary: var(--color-yellow-200);--elements-state-warning-borderColor-primary: var(--color-yellow-100);--elements-state-warning-backgroundColor-tertiary: var(--color-yellow-200);--elements-state-warning-backgroundColor-secondary: var(--color-yellow-100);--elements-state-warning-backgroundColor-primary: var(--color-yellow-50);--elements-state-warning-color-tertiary: var(--color-yellow-700);--elements-state-warning-color-secondary: var(--color-yellow-600);--elements-state-warning-color-primary: var(--color-yellow-500);--elements-state-success-borderColor-secondary: var(--color-green-200);--elements-state-success-borderColor-primary: var(--color-green-100);--elements-state-success-backgroundColor-tertiary: var(--color-green-200);--elements-state-success-backgroundColor-secondary: var(--color-green-100);--elements-state-success-backgroundColor-primary: var(--color-green-50);--elements-state-success-color-tertiary: var(--color-green-700);--elements-state-success-color-secondary: var(--color-green-600);--elements-state-success-color-primary: var(--color-green-500);--elements-state-info-borderColor-secondary: var(--color-blue-200);--elements-state-info-borderColor-primary: var(--color-blue-100);--elements-state-info-backgroundColor-tertiary: var(--color-blue-200);--elements-state-info-backgroundColor-secondary: var(--color-blue-100);--elements-state-info-backgroundColor-primary: var(--color-blue-50);--elements-state-info-color-tertiary: var(--color-blue-700);--elements-state-info-color-secondary: var(--color-blue-600);--elements-state-info-color-primary: var(--color-blue-500);--elements-state-secondary-borderColor-secondary: var(--color-secondary-200);--elements-state-secondary-borderColor-primary: var(--color-secondary-100);--elements-state-secondary-backgroundColor-tertiary: var(--color-secondary-200);--elements-state-secondary-backgroundColor-secondary: var(--color-secondary-100);--elements-state-secondary-backgroundColor-primary: var(--color-secondary-50);--elements-state-secondary-color-tertiary: var(--color-secondary-700);--elements-state-secondary-color-secondary: var(--color-secondary-600);--elements-state-secondary-color-primary: var(--color-secondary-500);--elements-state-primary-borderColor-secondary: var(--color-primary-200);--elements-state-primary-borderColor-primary: var(--color-primary-100);--elements-state-primary-backgroundColor-tertiary: var(--color-primary-200);--elements-state-primary-backgroundColor-secondary: var(--color-primary-100);--elements-state-primary-backgroundColor-primary: var(--color-primary-50);--elements-state-primary-color-tertiary: var(--color-primary-700);--elements-state-primary-color-secondary: var(--color-primary-600);--elements-state-primary-color-primary: var(--color-primary-500);--elements-state-neutral-borderColor-secondary: var(--color-gray-300);--elements-state-neutral-borderColor-primary: var(--color-gray-200);--elements-state-neutral-backgroundColor-tertiary: var(--color-gray-300);--elements-state-neutral-backgroundColor-secondary: var(--color-gray-200);--elements-state-neutral-backgroundColor-primary: var(--color-gray-100);--elements-state-neutral-color-tertiary: var(--color-gray-700);--elements-state-neutral-color-secondary: var(--color-gray-600);--elements-state-neutral-color-primary: var(--color-gray-500);--elements-surface-secondary-backgroundColor: var(--color-gray-200);--elements-surface-primary-backgroundColor: var(--color-gray-100);--elements-border-secondary-static: var(--color-gray-300);--elements-border-primary-hover: var(--color-gray-300);--elements-border-primary-static: var(--color-gray-200);--elements-text-tertiary-color-static: var(--color-gray-300);--elements-text-secondary-color-hover: var(--color-gray-700);--elements-text-secondary-color-static: var(--color-gray-500);--elements-text-primary-color-static: var(--color-gray-900);--elements-radii-base: var(--radii-3xs);--prose-code-inline-backgroundColor: var(--typography-color-secondary-100);--prose-code-inline-color: var(--typography-color-secondary-700);--prose-code-inline-fontWeight: var(--typography-fontWeight-normal);--prose-code-inline-fontSize: var(--typography-fontSize-sm);--prose-code-inline-borderRadius: var(--typography-radii-3xs);--prose-code-block-pre-padding: var(--typography-verticalMargin-sm);--prose-code-block-backgroundColor: var(--typography-color-secondary-50);--prose-code-block-color: var(--typography-color-secondary-700);--prose-code-block-borderRadius: var(--typography-radii-3xs);--prose-code-block-borderColor: var(--typography-color-secondary-200);--prose-code-block-margin: var(--typography-verticalMargin-base) 0;--prose-code-block-fontSize: var(--typography-fontSize-sm);--prose-tbody-code-inline-fontSize: var(--typography-fontSize-sm);--prose-tbody-td-padding: var(--typography-verticalMargin-sm);--prose-tbody-tr-borderBottom-color: var(--typography-color-secondary-200);--prose-th-fontWeight: var(--typography-fontWeight-semibold);--prose-th-padding: 0 var(--typography-verticalMargin-sm) var(--typography-verticalMargin-sm) var(--typography-verticalMargin-sm);--prose-th-color: var(--typography-color-secondary-600);--prose-thead-borderBottom-color: var(--typography-color-secondary-200);--prose-thead-border-color: var(--typography-color-secondary-300);--prose-table-lineHeight: var(--typography-lead-6);--prose-table-fontSize: var(--typography-fontSize-sm);--prose-table-margin: var(--typography-verticalMargin-base) 0;--prose-hr-color: var(--typography-color-secondary-200);--prose-hr-margin: var(--typography-verticalMargin-base) 0;--prose-li-margin: var(--typography-verticalMargin-sm) 0;--prose-ol-margin: var(--typography-verticalMargin-base) 0;--prose-ul-margin: var(--typography-verticalMargin-base) 0;--prose-blockquote-border-color: var(--typography-color-secondary-200);--prose-blockquote-color: var(--typography-color-secondary-500);--prose-blockquote-margin: var(--typography-verticalMargin-base) 0;--prose-a-code-background-hover: var(--typography-color-primary-50);--prose-a-code-border-color-hover: var(--typography-color-primary-500);--prose-a-code-border-color-static: var(--typography-color-secondary-400);--prose-a-code-border-style: var(--prose-a-border-style-static);--prose-a-code-border-width: var(--prose-a-border-width);--prose-a-fontWeight: var(--typography-fontWeight-medium);--prose-a-color-hover: var(--typography-color-primary-500);--prose-img-margin: var(--typography-verticalMargin-base) 0;--prose-strong-fontWeight: var(--typography-fontWeight-semibold);--prose-h6-iconSize: var(--typography-fontSize-base);--prose-h6-fontWeight: var(--typography-fontWeight-semibold);--prose-h6-lineHeight: var(--typography-lead-normal);--prose-h6-fontSize: var(--typography-fontSize-lg);--prose-h5-iconSize: var(--typography-fontSize-lg);--prose-h5-fontWeight: var(--typography-fontWeight-semibold);--prose-h5-lineHeight: var(--typography-lead-snug);--prose-h5-fontSize: var(--typography-fontSize-xl);--prose-h4-iconSize: var(--typography-fontSize-lg);--prose-h4-letterSpacing: var(--typography-letterSpacing-tight);--prose-h4-fontWeight: var(--typography-fontWeight-semibold);--prose-h4-lineHeight: var(--typography-lead-snug);--prose-h4-fontSize: var(--typography-fontSize-2xl);--prose-h3-iconSize: var(--typography-fontSize-xl);--prose-h3-letterSpacing: var(--typography-letterSpacing-tight);--prose-h3-fontWeight: var(--typography-fontWeight-semibold);--prose-h3-lineHeight: var(--typography-lead-snug);--prose-h3-fontSize: var(--typography-fontSize-3xl);--prose-h2-iconSize: var(--typography-fontSize-2xl);--prose-h2-letterSpacing: var(--typography-letterSpacing-tight);--prose-h2-fontWeight: var(--typography-fontWeight-semibold);--prose-h2-lineHeight: var(--typography-lead-tight);--prose-h2-fontSize: var(--typography-fontSize-4xl);--prose-h1-iconSize: var(--typography-fontSize-3xl);--prose-h1-letterSpacing: var(--typography-letterSpacing-tight);--prose-h1-fontWeight: var(--typography-fontWeight-bold);--prose-h1-lineHeight: var(--typography-lead-tight);--prose-h1-fontSize: var(--typography-fontSize-5xl);--prose-p-br-margin: var(--typography-verticalMargin-base) 0 0 0;--prose-p-margin: var(--typography-verticalMargin-base) 0;--prose-p-lineHeight: var(--typography-lead-normal);--prose-p-fontSize: var(--typography-fontSize-base);--typography-font-code: var(--typography-font-mono);--typography-font-body: var(--typography-font-sans);--typography-font-display: var(--typography-font-sans);--typography-body-backgroundColor: var(--typography-color-white);--typography-body-color: var(--typography-color-black);--text-6xl-lineHeight: var(--lead-none);--text-6xl-fontSize: var(--fontSize-6xl);--text-5xl-lineHeight: var(--lead-none);--text-5xl-fontSize: var(--fontSize-5xl);--text-4xl-lineHeight: var(--lead-10);--text-4xl-fontSize: var(--fontSize-4xl);--text-3xl-lineHeight: var(--lead-9);--text-3xl-fontSize: var(--fontSize-3xl);--text-2xl-lineHeight: var(--lead-8);--text-2xl-fontSize: var(--fontSize-2xl);--text-xl-lineHeight: var(--lead-7);--text-xl-fontSize: var(--fontSize-xl);--text-lg-lineHeight: var(--lead-7);--text-lg-fontSize: var(--fontSize-lg);--text-base-lineHeight: var(--lead-6);--text-base-fontSize: var(--fontSize-base);--text-sm-lineHeight: var(--lead-5);--text-sm-fontSize: var(--fontSize-sm);--text-xs-lineHeight: var(--lead-4);--text-xs-fontSize: var(--fontSize-xs);--shadow-2xl: 0px 25px 50px -12px var(--color-gray-900);--shadow-xl: 0px 20px 25px -5px var(--color-gray-400), 0px 8px 10px -6px #000000;--elements-sandbox-borderColor: var(--elements-border-secondary-static);--elements-sandbox-lineHeight: var(--text-3xl-lineHeight);--elements-sandbox-fontSize: var(--text-3xl-fontSize);--elements-sandbox-backgroundColor: var(--elements-surface-primary-backgroundColor);--elements-tooltip-content-borderRadius: var(--elements-radii-base);--elements-tooltip-content-lineHeight: var(--text-sm-lineHeight);--elements-tooltip-content-fontSize: var(--text-sm-fontSize);--elements-disclosure-opened-summary-borderTopRightRadius: var(--elements-radii-base);--elements-disclosure-opened-summary-borderTopLeftRadius: var(--elements-radii-base);--elements-disclosure-content-borderBottomRightRadius: var(--elements-radii-base);--elements-disclosure-content-borderBottomLeftRadius: var(--elements-radii-base);--elements-disclosure-summary-chevron-borderRadius: var(--elements-radii-base);--elements-disclosure-summary-borderRadius: var(--elements-radii-base);--elements-callout-title-lineHeight: var(--text-xl-lineHeight);--elements-callout-title-fontSize: var(--text-xl-fontSize);--elements-callout-icon-lineHeight: var(--text-xl-lineHeight);--elements-callout-icon-fontSize: var(--text-xl-fontSize);--elements-callout-borderRadius: var(--elements-radii-base);--elements-codeGroup-tabs-inactive-borderBlockEnd: 1px solid var(--elements-border-primary-static);--elements-codeGroup-tabs-borderInlineEnd: 1px solid var(--elements-border-primary-static);--elements-codeGroup-tabs-borderInlineStart: 1px solid var(--elements-border-primary-static);--elements-codeGroup-tabs-lineHeight: var(--text-sm-lineHeight);--elements-codeGroup-tabs-fontSize: var(--text-sm-fontSize);--elements-codeGroup-borderRadius: var(--elements-radii-base);--elements-codeGroup-borderColor: var(--elements-border-primary-static);--elements-codeCollapse-gradientBackdrop-background: linear-gradient(180deg, rgba(255, 255, 255, 0) 0%, var(--prose-code-block-backgroundColor) 100%);--elements-codeCollapse-button-color: var(--elements-text-secondary-color-static);--elements-codeCollapse-button-lineHeight: var(--text-sm-lineHeight);--elements-codeCollapse-button-fontSize: var(--text-sm-fontSize);--elements-codeCollapse-button-borderColor: var(--elements-border-secondary-static);--elements-codeCollapse-button-borderRadius: var(--elements-radii-base);--elements-codeCollapse-borderColor: var(--prose-code-block-borderColor);--elements-codeCollapse-borderRadius: var(--elements-radii-base);--elements-codeCollapse-margin: var(--prose-code-block-margin);--elements-buttonLink-giant-lineHeight: var(--text-xl-lineHeight);--elements-buttonLink-giant-fontSize: var(--text-xl-fontSize);--elements-buttonLink-large-lineHeight: var(--text-lg-lineHeight);--elements-buttonLink-large-fontSize: var(--text-lg-fontSize);--elements-buttonLink-medium-lineHeight: var(--text-base-lineHeight);--elements-buttonLink-medium-fontSize: var(--text-base-fontSize);--elements-buttonLink-small-lineHeight: var(--text-sm-lineHeight);--elements-buttonLink-small-fontSize: var(--text-sm-fontSize);--elements-badge-borderRadius: var(--elements-radii-base);--elements-badge-fontSize: var(--text-base-fontSize);--elements-alert-closeButton-border-radius: var(--elements-radii-base);--elements-alert-borderRadius: var(--elements-radii-base);--elements-announce-lineHeight: var(--text-sm-lineHeight);--elements-announce-fontSize: var(--text-sm-fontSize);--elements-announce-borderColor: var(--elements-border-primary-static);--prose-a-code-color-static: var(--prose-code-inline-color); } }@media { :root.dark {--pinceau-mq: dark; --elements-tooltip-content-borderStyle: solid;--elements-tooltip-content-borderWidth: 1px;--elements-backdrop-background: #0c0d0ccc;--prose-code-block-backdropFilter: contrast(1);--prose-ol-li-markerColor: currentColor;--prose-ul-li-markerColor: currentColor;--prose-a-code-color-hover: currentColor;--prose-a-border-color-hover: currentColor;--prose-a-border-color-static: currentColor;--prose-a-color-static: inherit;--elements-modal-scrim-backgroundColor: var(--color-gray-900);--elements-tooltip-content-borderColor: var(--color-gray-700);--elements-tooltip-content-backgroundColor: var(--color-gray-800);--elements-codeGroup-tabs-active-backgroundColor: var(--prose-code-block-backgroundColor);--elements-codeGroup-tabs-active-color: var(--color-gray-300);--elements-codeGroup-tabs-inactive-backgroundColor: var(--color-black);--elements-codeGroup-tabs-inactive-color-hover: var(--color-gray-300);--elements-codeGroup-tabs-inactive-color-static: var(--color-gray-500);--elements-codeCollapse-button-backgroundColor: var(--color-black);--elements-announce-icon-backgroundColor: var(--color-gray-700);--elements-announce-backgroundColor: var(--color-gray-800);--elements-state-danger-borderColor-secondary: var(--color-red-700);--elements-state-danger-borderColor-primary: var(--color-red-800);--elements-state-danger-backgroundColor-tertiary: var(--color-red-700);--elements-state-danger-backgroundColor-secondary: var(--color-red-800);--elements-state-danger-backgroundColor-primary: var(--color-red-900);--elements-state-danger-color-tertiary: var(--color-red-100);--elements-state-danger-color-secondary: var(--color-red-400);--elements-state-danger-color-primary: var(--color-red-500);--elements-state-warning-borderColor-secondary: var(--color-yellow-700);--elements-state-warning-borderColor-primary: var(--color-yellow-800);--elements-state-warning-backgroundColor-tertiary: var(--color-yellow-700);--elements-state-warning-backgroundColor-secondary: var(--color-yellow-800);--elements-state-warning-backgroundColor-primary: var(--color-yellow-900);--elements-state-warning-color-tertiary: var(--color-yellow-100);--elements-state-warning-color-secondary: var(--color-yellow-400);--elements-state-warning-color-primary: var(--color-yellow-500);--elements-state-success-borderColor-secondary: var(--color-green-700);--elements-state-success-borderColor-primary: var(--color-green-800);--elements-state-success-backgroundColor-tertiary: var(--color-green-700);--elements-state-success-backgroundColor-secondary: var(--color-green-800);--elements-state-success-backgroundColor-primary: var(--color-green-900);--elements-state-success-color-tertiary: var(--color-green-100);--elements-state-success-color-secondary: var(--color-green-400);--elements-state-success-color-primary: var(--color-green-500);--elements-state-info-borderColor-secondary: var(--color-blue-700);--elements-state-info-borderColor-primary: var(--color-blue-800);--elements-state-info-backgroundColor-tertiary: var(--color-blue-700);--elements-state-info-backgroundColor-secondary: var(--color-blue-800);--elements-state-info-backgroundColor-primary: var(--color-blue-900);--elements-state-info-color-tertiary: var(--color-blue-100);--elements-state-info-color-secondary: var(--color-blue-400);--elements-state-info-color-primary: var(--color-blue-500);--elements-state-secondary-borderColor-secondary: var(--color-secondary-700);--elements-state-secondary-borderColor-primary: var(--color-secondary-800);--elements-state-secondary-backgroundColor-tertiary: var(--color-secondary-700);--elements-state-secondary-backgroundColor-secondary: var(--color-secondary-800);--elements-state-secondary-backgroundColor-primary: var(--color-secondary-900);--elements-state-secondary-color-tertiary: var(--color-secondary-100);--elements-state-secondary-color-secondary: var(--color-secondary-400);--elements-state-secondary-color-primary: var(--color-secondary-500);--elements-state-primary-borderColor-secondary: var(--color-primary-700);--elements-state-primary-borderColor-primary: var(--color-primary-800);--elements-state-primary-backgroundColor-tertiary: var(--color-primary-700);--elements-state-primary-backgroundColor-secondary: var(--color-primary-800);--elements-state-primary-backgroundColor-primary: var(--color-primary-900);--elements-state-primary-color-tertiary: var(--color-primary-100);--elements-state-primary-color-secondary: var(--color-primary-400);--elements-state-primary-color-primary: var(--color-primary-500);--elements-state-neutral-borderColor-secondary: var(--color-gray-600);--elements-state-neutral-borderColor-primary: var(--color-gray-700);--elements-state-neutral-backgroundColor-tertiary: var(--color-gray-600);--elements-state-neutral-backgroundColor-secondary: var(--color-gray-700);--elements-state-neutral-backgroundColor-primary: var(--color-gray-800);--elements-state-neutral-color-tertiary: var(--color-gray-100);--elements-state-neutral-color-secondary: var(--color-gray-400);--elements-state-neutral-color-primary: var(--color-gray-500);--elements-surface-secondary-backgroundColor: var(--color-gray-800);--elements-surface-primary-backgroundColor: var(--color-gray-900);--elements-border-secondary-static: var(--color-gray-700);--elements-border-primary-hover: var(--color-gray-700);--elements-border-primary-static: var(--color-gray-800);--elements-text-tertiary-color-static: var(--color-gray-600);--elements-text-secondary-color-hover: var(--color-gray-200);--elements-text-secondary-color-static: var(--color-gray-400);--elements-text-primary-color-static: var(--color-gray-50);--prose-code-inline-backgroundColor: var(--typography-color-secondary-700);--prose-code-inline-color: var(--typography-color-secondary-200);--prose-code-block-backgroundColor: var(--typography-color-secondary-900);--prose-code-block-color: var(--typography-color-secondary-200);--prose-code-block-borderColor: var(--typography-color-secondary-800);--prose-tbody-tr-borderBottom-color: var(--typography-color-secondary-800);--prose-th-color: var(--typography-color-secondary-400);--prose-thead-borderBottom-color: var(--typography-color-secondary-800);--prose-thead-border-color: var(--typography-color-secondary-600);--prose-hr-color: var(--typography-color-secondary-800);--prose-blockquote-border-color: var(--typography-color-secondary-700);--prose-blockquote-color: var(--typography-color-secondary-400);--prose-a-code-background-hover: var(--typography-color-primary-900);--prose-a-code-border-color-hover: var(--typography-color-primary-600);--prose-a-code-border-color-static: var(--typography-color-secondary-600);--prose-a-color-hover: var(--typography-color-primary-500);--typography-body-backgroundColor: var(--typography-color-black);--typography-body-color: var(--typography-color-white); } }@media (min-width: 475px) { :root {--pinceau-mq: xs; --test: 1px; } }@media (min-width: 640px) { :root {--pinceau-mq: sm; --test: 2px; } }@media (min-width: 768px) { :root {--pinceau-mq: md; --test: 3px; } }@media (min-width: 1024px) { :root {--pinceau-mq: lg; --test: 4px; } }@media (min-width: 1280px) { :root {--pinceau-mq: xl; --test: 5px; } }@media (min-width: 1536px) { :root {--pinceau-mq: 2xl; --test: 6px; } }</style><style id="pinceau-runtime-hydratable"></style><link rel="stylesheet" href="/_nuxt/entry.b2c8c71d.css"><link rel="stylesheet" href="/_nuxt/ProseHr.1cdf549c.css"><link rel="stylesheet" href="/_nuxt/ProseH1.88370863.css"><link rel="stylesheet" href="/_nuxt/ProseP.05611450.css"><link rel="stylesheet" href="/_nuxt/ProseH2.2119cb0f.css"><link rel="stylesheet" href="/_nuxt/ProseA.2842c197.css"><link rel="stylesheet" href="/_nuxt/ProseBlockquote.7f2b4622.css"><link rel="stylesheet" href="/_nuxt/ProseStrong.9e61c61f.css"><link rel="stylesheet" href="/_nuxt/ProseOl.283d6fa8.css"><link rel="stylesheet" href="/_nuxt/ProseLi.b91c4a22.css"><link rel="stylesheet" href="/_nuxt/ProseCode.f723dbd6.css"><link rel="stylesheet" href="/_nuxt/ProseCodeInline.18e52e56.css"><link rel="stylesheet" href="/_nuxt/ProseTable.b652fe84.css"><link rel="stylesheet" href="/_nuxt/ProseThead.b93fb938.css"><link rel="stylesheet" href="/_nuxt/ProseTr.59c44cd9.css"><link rel="stylesheet" href="/_nuxt/ProseTh.abf500a3.css"><link rel="stylesheet" href="/_nuxt/ProseTd.8ee8d87a.css"><script>"use strict";(()=>{const a=window,e=document.documentElement,m=["dark","light"],c=window.localStorage.getItem("nuxt-color-mode")||"system";let n=c==="system"?f():c;const l=e.getAttribute("data-color-mode-forced");l&&(n=l),i(n),a["__NUXT_COLOR_MODE__"]={preference:c,value:n,getColorScheme:f,addColorScheme:i,removeColorScheme:d};function i(o){const t=""+o+"",s="";e.classList?e.classList.add(t):e.className+=" "+t,s&&e.setAttribute("data-"+s,o)}function d(o){const t=""+o+"",s="";e.classList?e.classList.remove(t):e.className=e.className.replace(new RegExp(t,"g"),""),s&&e.removeAttribute("data-"+s)}function r(o){return a.matchMedia("(prefers-color-scheme"+o+")")}function f(){if(a.matchMedia&&r("").media!=="not all"){for(const o of m)if(r(":"+o).matches)return o}return"light"}})();
</script></head>
<body ><div id="__nuxt"><div class="sm:pt-6 sm:pb-10"><!----><!----><!----><div class="nuxt-progress" style="width:0%;height:3px;opacity:0;background-size:Infinity% auto;"></div><div class="flex justify-between max-w-2xl px-4 py-4 mx-auto sm:px-8"><div class="text-primary-700 dark:text-primary-200"><!--[--><a href="/" class="mr-6">Home</a><a href="/about" class="mr-6">About</a><a href="/blog" class="mr-6">Blog</a><!--]--></div><div class="space-x-3 transition text-primary-500"><!----><a href="https://github.com/MrThygesen16" title="GitHub" class="dark:text-primary-100 hover:text-primary-700 dark:hover:text-primary-300"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon w-5 h-5" style="" width="1em" height="1em" viewBox="0 0 496 512" data-v-cbd0add2><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6c-3.3.3-5.6-1.3-5.6-3.6c0-2 2.3-3.6 5.2-3.6c3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9c2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9c.3 2 2.9 3.3 5.9 2.6c2.9-.7 4.9-2.6 4.6-4.6c-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2c12.8 2.3 17.3-5.6 17.3-12.1c0-6.2-.3-40.4-.3-61.4c0 0-70 15-84.7-29.8c0 0-11.4-29.1-27.8-36.6c0 0-22.9-15.7 1.6-15.4c0 0 24.9 2 38.6 25.8c21.9 38.6 58.6 27.5 72.9 20.9c2.3-16 8.8-27.1 16-33.7c-55.9-6.2-112.3-14.3-112.3-110.5c0-27.5 7.6-41.3 23.6-58.9c-2.6-6.5-11.1-33.3 2.6-67.9c20.9-6.5 69 27 69 27c20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27c13.7 34.7 5.2 61.4 2.6 67.9c16 17.7 25.8 31.5 25.8 58.9c0 96.5-58.9 104.2-114.8 110.5c9.2 7.9 17 22.9 17 46.4c0 33.7-.3 75.4-.3 83.6c0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252C496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2c1.6 1.6 3.9 2.3 5.2 1c1.3-1 1-3.3-.7-5.2c-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9c1.6 1 3.6.7 4.3-.7c.7-1.3-.3-2.9-2.3-3.9c-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2c2.3 2.3 5.2 2.6 6.5 1c1.3-1.3.7-4.3-1.3-6.2c-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2c-1.4-2.3-4-3.3-5.6-2"/></svg></a><button aria-label="Color Mode" class="inline-block w-5 dark:text-primary-100 hover:text-primary-700 dark:hover:text-primary-300"><span>...</span></button></div></div><!--[--><div class="document-driven-page"><div class="py-10 m-auto bg-white sm:px-8 ring-1 ring-gray-200 dark:ring-gray-700 dark:bg-primary-800 sm:rounded"><main class="max-w-2xl px-4 mx-auto sm:px-8"><!--[--><div><hr class="prose-hr" data-v-2030c92c><h1 id="secure-environment-variable-injection-using-azapi-azurerm" class="prose-h1" data-v-5c476b2e><a aria-current="page" href="/blog/secure-variable-injection#secure-environment-variable-injection-using-azapi-azurerm" class="router-link-active router-link-exact-active" data-v-5c476b2e><!--[-->Secure Environment Variable Injection using AzAPI &amp; AzureRM<!--]--><!----></a></h1><p class="prose-p" data-v-f4353d2d><!--[-->2025/08/05<!--]--></p><hr class="prose-hr" data-v-2030c92c><h2 id="framing-the-problem" class="prose-h2" data-v-53a328d0><a aria-current="page" href="/blog/secure-variable-injection#framing-the-problem" class="router-link-active router-link-exact-active" data-v-53a328d0><!--[-->Framing the problem<!--]--><!----></a></h2><p class="prose-p" data-v-f4353d2d><!--[--><a href="https://github.com/MrThygesen16/tf-aci-secret-inject" rel="nofollow" class="prose-a" data-v-9a902551><!--[-->Full code can be found here.<!--]--></a><!--]--></p><p class="prose-p" data-v-f4353d2d><!--[-->When creating Container Instances in Azure, it is recommended to provision a Managed Identity alongside the Container Instance. We can use this Managed Identity to generate an Entra ID token &amp; use that for Authentication. A prime example would be provisioning Container Instances for privately hosted Azure DevOps agents.<!--]--></p><p class="prose-p" data-v-f4353d2d><!--[-->The benefits of this approach means we don&#39;t have to worry about handling secrets; no need for a key-vault or secure variables in Azure DevOps. More importantly, this means we are not writing any secrets to State in Terraform. Writing secrets directly to state leads to a problem called <a href="https://www.hashicorp.com/en/resources/what-is-secret-sprawl-why-is-it-harmful" rel="nofollow" class="prose-a" data-v-9a902551><!--[-->&quot;Secret Sprawl&quot;<!--]--></a>:<!--]--></p><blockquote class="prose-blockquote" data-v-3d119438><!--[--><p class="prose-p" data-v-f4353d2d><!--[-->Secret Sprawl is the uncontrolled and unmanaged proliferation of sensitive information like API keys, passwords, and encryption keys across an organization&#39;s digital environment. This happens when these secrets are scattered across various systems, applications, and even unsecured communication channels without proper tracking or control.<!--]--></p><!--]--></blockquote><p class="prose-p" data-v-f4353d2d><!--[-->The above solution works well when using a Linux-based container image. For Windows Containers however, it is a different story.<!--]--></p><p class="prose-p" data-v-f4353d2d><!--[--><a href="https://learn.microsoft.com/en-us/azure/container-instances/container-instances-managed-identity#managed-identity-on-windows-containers" rel="nofollow" class="prose-a" data-v-9a902551><!--[-->Microsoft Documentation on Container Instances highlights this issue:<!--]--></a><!--]--></p><blockquote class="prose-blockquote" data-v-3d119438><!--[--><p class="prose-p" data-v-f4353d2d><!--[-->Managed Identity on Windows container groups works differently than Linux container groups. <strong class="prose-strong" data-v-849f2d6a><!--[-->For Windows containers, metadata server (169.254.169.254) is not available for getting the Microsoft Entra ID token<!--]--></strong>.<!--]--></p><!--]--></blockquote><p class="prose-p" data-v-f4353d2d><!--[-->The docs further state:<!--]--></p><blockquote class="prose-blockquote" data-v-3d119438><!--[--><p class="prose-p" data-v-f4353d2d><!--[--><strong class="prose-strong" data-v-849f2d6a><!--[-->Az Login module and other client libraries which depend on metadata server (169.254.169.254) will not work in a Windows Container. Additionally, Windows containers in vNet won&#39;t be able to connect to the endpoint; hence, a managed identity token can&#39;t be generated in a Windows virtual network container.<!--]--></strong><!--]--></p><!--]--></blockquote><p class="prose-p" data-v-f4353d2d><!--[-->Essentially, doing the approach described above (using a managed identity to create an Entra ID token) is not possible.<!--]--></p><p class="prose-p" data-v-f4353d2d><!--[-->Let&#39;s take the following Terraform snippet(s) as an example:<!--]--></p><ol class="prose-ol" data-v-8e545359><!--[--><li class="prose-li" data-v-05c6bdd9><!--[-->First we will create a resource group<!--]--></li><!--]--></ol><div class="highlight-terraform prose-code language-terraform" meta data-v-cafe2a2b><!----><!--[--><pre><code><span class="line" line="1"><span># main.tf
</span></span><span class="line" line="2"><span>resource &quot;azurerm_resource_group&quot; &quot;this&quot; {
</span></span><span class="line" line="3"><span>  name     = &quot;rg-acg-example-01&quot;
</span></span><span class="line" line="4"><span>  location = &quot;AustraliaEast&quot;
</span></span><span class="line" line="5"><span>}</span></span></code></pre><!--]--><button class="copy-button" data-v-cafe2a2b data-v-0a12b65b><span class="sr-only" data-v-0a12b65b>Copy to clipboard</span><span class="icon-wrapper" data-v-0a12b65b><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-0a12b65b style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-cbd0add2><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><ol class="prose-ol" start="2" data-v-8e545359><!--[--><li class="prose-li" data-v-05c6bdd9><!--[-->Create a container group<!--]--></li><!--]--></ol><div class="highlight-terraform prose-code language-terraform" meta data-v-cafe2a2b><!----><!--[--><pre><code><span class="line" line="1"><span># main.tf (cont.) - Insecure Windows Container Group
</span></span><span class="line" line="2"><span>resource &quot;azurerm_container_group&quot; &quot;unsecure&quot; {
</span></span><span class="line" line="3"><span>  name                = &quot;acg-windows-insecure-01&quot;
</span></span><span class="line" line="4"><span>  location            = azurerm_resource_group.this.location
</span></span><span class="line" line="5"><span>  resource_group_name = azurerm_resource_group.this.name
</span></span><span class="line" line="6"><span>  os_type             = &quot;Windows&quot;
</span></span><span class="line" line="7"><span>
</span></span><span class="line" line="8"><span>  container {
</span></span><span class="line" line="9"><span>    name   = &quot;aci-win-02&quot;
</span></span><span class="line" line="10"><span>    image  = &quot;mcr.microsoft.com/windows/servercore:ltsc2022&quot;
</span></span><span class="line" line="11"><span>    cpu    = &quot;0.5&quot;
</span></span><span class="line" line="12"><span>    memory = &quot;0.5&quot;
</span></span><span class="line" line="13"><span>
</span></span><span class="line" line="14"><span>    ports {
</span></span><span class="line" line="15"><span>      port     = &quot;22&quot;
</span></span><span class="line" line="16"><span>      protocol = &quot;TCP&quot;
</span></span><span class="line" line="17"><span>    }
</span></span><span class="line" line="18"><span>
</span></span><span class="line" line="19"><span>    commands = []
</span></span><span class="line" line="20"><span>    
</span></span><span class="line" line="21"><span>    ## secrets added to state
</span></span><span class="line" line="22"><span>    environment_variables = { 
</span></span><span class="line" line="23"><span>        &quot;non_secure_var&quot; = &quot;NonSecureValueExposed&quot; 
</span></span><span class="line" line="24"><span>    }
</span></span><span class="line" line="25"><span>    # Would be better to pass this in as a variable
</span></span><span class="line" line="26"><span>    # but for the sake of this demo -- this is simpler
</span></span><span class="line" line="27"><span>    secure_environment_variables = { 
</span></span><span class="line" line="28"><span>        &quot;secure_var&quot; = &quot;SecureValueExposed&quot; 
</span></span><span class="line" line="29"><span>    }
</span></span><span class="line" line="30"><span>  }
</span></span><span class="line" line="31"><span>}</span></span></code></pre><!--]--><button class="copy-button" data-v-cafe2a2b data-v-0a12b65b><span class="sr-only" data-v-0a12b65b>Copy to clipboard</span><span class="icon-wrapper" data-v-0a12b65b><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-0a12b65b style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-cbd0add2><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p class="prose-p" data-v-f4353d2d><!--[-->We can check the Azure portal and confirm that our two environment variables have been added to the Container.
Furthermore, notice that Azure does not display the value of the environment variable <code class="prose-code-inline" data-v-b1dc14d9><!--[-->secure_var<!--]--></code>.<!--]--></p><div class="prose-table" data-v-507c1153><table data-v-507c1153><!--[--><thead class="prose-thead" data-v-e7dae2ea><!--[--><tr class="prose-tr" data-v-3805cf3e><!--[--><th class="prose-th" data-v-481388ac><!--[-->Key<!--]--></th><th class="prose-th" data-v-481388ac><!--[-->Value<!--]--></th><!--]--></tr><!--]--></thead><tbody class="prose-tbody"><!--[--><tr class="prose-tr" data-v-3805cf3e><!--[--><td class="prose-td" data-v-575bdb23><!--[-->non_secure_var<!--]--></td><td class="prose-td" data-v-575bdb23><!--[-->NonSecureValue<!--]--></td><!--]--></tr><tr class="prose-tr" data-v-3805cf3e><!--[--><td class="prose-td" data-v-575bdb23><!--[-->secure_var<!--]--></td><td class="prose-td" data-v-575bdb23><!--[--><!--]--></td><!--]--></tr><!--]--></tbody><!--]--></table></div><p class="prose-p" data-v-f4353d2d><!--[-->However, when we look at our State file, we can see that the secrets - including the secure variable is stored in plain-text.<!--]--></p><div class="highlight-json prose-code language-json" meta data-v-cafe2a2b><!----><!--[--><pre><code><span class="line" line="1"><span class="ct-128513">// terraform.tfstate
</span></span><span class="line" line="2"><span class="ct-667011">&quot;environment_variables&quot;</span><span class="ct-935781">: {
</span></span><span class="line" line="3"><span class="ct-935781">    </span><span class="ct-238295">&quot;non_secure_var&quot;</span><span class="ct-935781">: </span><span class="ct-667011">&quot;NonSecureValue&quot;
</span></span><span class="line" line="4"><span class="ct-935781">},
</span></span><span class="line" line="5"><span class="ct-667011">&quot;secure_environment_variables&quot;</span><span class="ct-935781">: {
</span></span><span class="line" line="6"><span class="ct-935781">    </span><span class="ct-238295">&quot;secure_var&quot;</span><span class="ct-935781">: </span><span class="ct-667011">&quot;SecureValue&quot;
</span></span><span class="line" line="7"><span class="ct-935781">},</span></span></code></pre><!--]--><button class="copy-button" data-v-cafe2a2b data-v-0a12b65b><span class="sr-only" data-v-0a12b65b>Copy to clipboard</span><span class="icon-wrapper" data-v-0a12b65b><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-0a12b65b style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-cbd0add2><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p class="prose-p" data-v-f4353d2d><!--[-->Unfortunately, this means that anyone who has read-access to state can view these secrets.<!--]--></p><h2 id="solution" class="prose-h2" data-v-53a328d0><a aria-current="page" href="/blog/secure-variable-injection#solution" class="router-link-active router-link-exact-active" data-v-53a328d0><!--[-->Solution<!--]--><!----></a></h2><p class="prose-p" data-v-f4353d2d><!--[-->We can solve this issue by using AzAPI.<!--]--></p><ol class="prose-ol" data-v-8e545359><!--[--><li class="prose-li" data-v-05c6bdd9><!--[-->Create another Container group; this time we don&#39;t add the secrets in, and instead add a lifecycle ignore block on the environment variables object (otherwise Terraform will complain)<!--]--></li><!--]--></ol><div class="highlight-terraform prose-code language-terraform" meta data-v-cafe2a2b><!----><!--[--><pre><code><span class="line" line="1"><span># main.tf (cont.) Secure Windows Container Group
</span></span><span class="line" line="2"><span>resource &quot;azurerm_container_group&quot; &quot;secure&quot; {
</span></span><span class="line" line="3"><span>  name                = &quot;acg-windows-secure-01&quot;
</span></span><span class="line" line="4"><span>  location            = azurerm_resource_group.this.location
</span></span><span class="line" line="5"><span>  resource_group_name = azurerm_resource_group.this.name
</span></span><span class="line" line="6"><span>  os_type             = &quot;Windows&quot;
</span></span><span class="line" line="7"><span>
</span></span><span class="line" line="8"><span>  container {
</span></span><span class="line" line="9"><span>    name   = &quot;aci-win-01&quot;
</span></span><span class="line" line="10"><span>    image  = &quot;mcr.microsoft.com/windows/servercore:ltsc2022&quot;
</span></span><span class="line" line="11"><span>    cpu    = &quot;0.5&quot;
</span></span><span class="line" line="12"><span>    memory = &quot;0.5&quot;
</span></span><span class="line" line="13"><span>
</span></span><span class="line" line="14"><span>    ports {
</span></span><span class="line" line="15"><span>      port     = &quot;22&quot;
</span></span><span class="line" line="16"><span>      protocol = &quot;TCP&quot;
</span></span><span class="line" line="17"><span>    }
</span></span><span class="line" line="18"><span>
</span></span><span class="line" line="19"><span>    ## let azapi inject these secrets
</span></span><span class="line" line="20"><span>    # commands = []
</span></span><span class="line" line="21"><span>    # environment_variables = {}
</span></span><span class="line" line="22"><span>  }
</span></span><span class="line" line="23"><span>
</span></span><span class="line" line="24"><span>  lifecycle {
</span></span><span class="line" line="25"><span>    ignore_changes = [
</span></span><span class="line" line="26"><span>      container[0].environment_variables,
</span></span><span class="line" line="27"><span>      container[0].commands,
</span></span><span class="line" line="28"><span>    ]
</span></span><span class="line" line="29"><span>  }
</span></span><span class="line" line="30"><span>}</span></span></code></pre><!--]--><button class="copy-button" data-v-cafe2a2b data-v-0a12b65b><span class="sr-only" data-v-0a12b65b>Copy to clipboard</span><span class="icon-wrapper" data-v-0a12b65b><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-0a12b65b style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-cbd0add2><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><ol class="prose-ol" start="2" data-v-8e545359><!--[--><li class="prose-li" data-v-05c6bdd9><!--[-->Next we use AzAPI to Stop the container by sending a POST request to the Container Group<!--]--></li><!--]--></ol><div class="highlight-terraform prose-code language-terraform" meta data-v-cafe2a2b><!----><!--[--><pre><code><span class="line" line="1"><span># main.tf (cont.) stop container group
</span></span><span class="line" line="2"><span>resource &quot;azapi_resource_action&quot; &quot;stop_container_group&quot; {
</span></span><span class="line" line="3"><span>  type        = &quot;Microsoft.ContainerInstance/containerGroups@2023-05-01&quot;
</span></span><span class="line" line="4"><span>  resource_id = azurerm_container_group.secure.id
</span></span><span class="line" line="5"><span>  action      = &quot;stop&quot;
</span></span><span class="line" line="6"><span>  method      = &quot;POST&quot;
</span></span><span class="line" line="7"><span>}</span></span></code></pre><!--]--><button class="copy-button" data-v-cafe2a2b data-v-0a12b65b><span class="sr-only" data-v-0a12b65b>Copy to clipboard</span><span class="icon-wrapper" data-v-0a12b65b><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-0a12b65b style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-cbd0add2><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><ol class="prose-ol" start="3" data-v-8e545359><!--[--><li class="prose-li" data-v-05c6bdd9><!--[-->Also using AzAPI, we use the resource <code class="prose-code-inline" data-v-b1dc14d9><!--[-->update_resource<!--]--></code> to inject the variables.<!--]--></li><!--]--></ol><div class="highlight-terraform prose-code language-terraform" meta data-v-cafe2a2b><!----><!--[--><pre><code><span class="line" line="1"><span># main.tf (cont.) inject secrets
</span></span><span class="line" line="2"><span>resource &quot;azapi_update_resource&quot; &quot;inject_secrets&quot; {
</span></span><span class="line" line="3"><span>  type        = &quot;Microsoft.ContainerInstance/containerGroups@2023-05-01&quot;
</span></span><span class="line" line="4"><span>  resource_id = azurerm_container_group.secure.id
</span></span><span class="line" line="5"><span>  
</span></span><span class="line" line="6"><span>  # rather than using `body`, we use `sensitive_body`
</span></span><span class="line" line="7"><span>  sensitive_body = {
</span></span><span class="line" line="8"><span>    properties = {
</span></span><span class="line" line="9"><span>      containers = [
</span></span><span class="line" line="10"><span>        {
</span></span><span class="line" line="11"><span>          name = azurerm_container_group.secure.container[0].name
</span></span><span class="line" line="12"><span>          properties = {
</span></span><span class="line" line="13"><span>            environmentVariables = [
</span></span><span class="line" line="14"><span>              {
</span></span><span class="line" line="15"><span>                name  = &quot;non_secure_var&quot;
</span></span><span class="line" line="16"><span>                value = &quot;NonSecureValueHidden&quot;
</span></span><span class="line" line="17"><span>              },
</span></span><span class="line" line="18"><span>              {
</span></span><span class="line" line="19"><span>                name        = &quot;secure_var&quot;
</span></span><span class="line" line="20"><span>                secureValue = &quot;SecureValueHidden&quot;
</span></span><span class="line" line="21"><span>              }
</span></span><span class="line" line="22"><span>            ]
</span></span><span class="line" line="23"><span>          }
</span></span><span class="line" line="24"><span>        }
</span></span><span class="line" line="25"><span>      ]
</span></span><span class="line" line="26"><span>    }
</span></span><span class="line" line="27"><span>  }
</span></span><span class="line" line="28"><span>}</span></span></code></pre><!--]--><button class="copy-button" data-v-cafe2a2b data-v-0a12b65b><span class="sr-only" data-v-0a12b65b>Copy to clipboard</span><span class="icon-wrapper" data-v-0a12b65b><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-0a12b65b style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-cbd0add2><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p class="prose-p" data-v-f4353d2d><!--[-->The reason we are able to update these values and not have them written to state is due to the introduction of <a href="https://registry.terraform.io/providers/Azure/azapi/latest/docs/guides/feature_ephemeral_resource#write-only-attributes" rel="nofollow" class="prose-a" data-v-9a902551><!--[-->&quot;Ephemeral Resources &amp; Write-Only Attributes in Terraform&quot;<!--]--></a>:<!--]--></p><blockquote class="prose-blockquote" data-v-3d119438><!--[--><p class="prose-p" data-v-f4353d2d><!--[-->Write-only arguments let you securely pass temporary values to Terraform&#39;s managed resources during an operation without persisting those values to state or plan files.<!--]--></p><p class="prose-p" data-v-f4353d2d><!--[-->The AzAPI provider supports sensitive_body to define attributes that are not stored in the state file, ensuring sensitive information remains secure<!--]--></p><!--]--></blockquote><ol class="prose-ol" start="4" data-v-8e545359><!--[--><li class="prose-li" data-v-05c6bdd9><!--[-->Lastly, we start the container group again.<!--]--></li><!--]--></ol><div class="highlight-terraform prose-code language-terraform" meta data-v-cafe2a2b><!----><!--[--><pre><code><span class="line" line="1"><span># main.tf (cont.) start container group
</span></span><span class="line" line="2"><span>resource &quot;azapi_resource_action&quot; &quot;start_container_group&quot; {
</span></span><span class="line" line="3"><span>  type        = &quot;Microsoft.ContainerInstance/containerGroups@2022-05-01&quot;
</span></span><span class="line" line="4"><span>  resource_id = azurerm_container_group.secure.id
</span></span><span class="line" line="5"><span>  action      = &quot;start&quot;
</span></span><span class="line" line="6"><span>  method      = &quot;POST&quot;
</span></span><span class="line" line="7"><span>
</span></span><span class="line" line="8"><span>  depends_on = [
</span></span><span class="line" line="9"><span>    azapi_update_resource.inject_secrets, 
</span></span><span class="line" line="10"><span>    azapi_resource_action.stop_container_group
</span></span><span class="line" line="11"><span>  ]
</span></span><span class="line" line="12"><span>}</span></span></code></pre><!--]--><button class="copy-button" data-v-cafe2a2b data-v-0a12b65b><span class="sr-only" data-v-0a12b65b>Copy to clipboard</span><span class="icon-wrapper" data-v-0a12b65b><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-0a12b65b style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-cbd0add2><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p class="prose-p" data-v-f4353d2d><!--[-->This is purely anecdotal, but I&#39;ve found that stopping, injecting secrets, and then starting the container group yields more consistent results.<!--]--></p><p class="prose-p" data-v-f4353d2d><!--[-->Finally, when we take a look at the state file for the container where we injected the secrets, we can see that neither the non-secure, nor the secure environment variables have been written to state.<!--]--></p><div class="highlight-json prose-code language-json" meta data-v-cafe2a2b><!----><!--[--><pre><code><span class="line" line="1"><span class="ct-128513">// terraforn.tfstate
</span></span><span class="line" line="2"><span class="ct-667011">&quot;environment_variables&quot;</span><span class="ct-935781">: </span><span class="ct-998471">null</span><span class="ct-935781">,
</span></span><span class="line" line="3"><span class="ct-667011">&quot;secure_environment_variables&quot;</span><span class="ct-935781">: </span><span class="ct-998471">null</span></span></code></pre><!--]--><button class="copy-button" data-v-cafe2a2b data-v-0a12b65b><span class="sr-only" data-v-0a12b65b>Copy to clipboard</span><span class="icon-wrapper" data-v-0a12b65b><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-0a12b65b style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-cbd0add2><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><style>.dark .ct-128513{color:#8B949E;}
.ct-128513{color:#6E7781;}
.dark .ct-667011{color:#A5D6FF;}
.ct-667011{color:#0A3069;}
.dark .ct-935781{color:#C9D1D9;}
.ct-935781{color:#24292F;}
.dark .ct-238295{color:#7EE787;}
.ct-238295{color:#116329;}
.dark .ct-998471{color:#79C0FF;}
.ct-998471{color:#0550AE;}</style></div><!--]--></main></div></div><!--]--></div></div><script type="application/json" id="__NUXT_DATA__" data-ssr="true">[["Reactive",1],{"data":2,"state":3,"_errors":1521,"serverRendered":6,"path":10},{},{"$scolor-mode":4,"$sdd-pages":8,"$sdd-surrounds":1474,"$sdd-globals":1483,"$sdd-navigation":1484,"$sicons":1512},{"preference":5,"value":5,"unknown":6,"forced":7},"system",true,false,{"/blog/secure-variable-injection":9},{"_path":10,"_dir":11,"_draft":7,"_partial":7,"_locale":12,"_empty":7,"title":13,"description":14,"date":14,"draft":7,"layout":15,"body":16,"_type":1469,"_id":1470,"_source":1471,"_file":1472,"_extension":1473},"/blog/secure-variable-injection","blog","","Secure Environment Variable Injection using AzAPI & AzureRM","2025/08/05","full-width",{"type":17,"children":18,"toc":1465},"root",[19,24,31,36,39,46,58,63,77,86,91,101,117,122,133,138,143,153,215,223,503,515,567,572,682,687,693,698,706,939,947,1013,1028,1257,1270,1283,1291,1394,1399,1404,1460],{"type":20,"tag":21,"props":22,"children":23},"element","hr",{},[],{"type":20,"tag":25,"props":26,"children":28},"h1",{"id":27},"secure-environment-variable-injection-using-azapi-azurerm",[29],{"type":30,"value":13},"text",{"type":20,"tag":32,"props":33,"children":34},"p",{},[35],{"type":30,"value":14},{"type":20,"tag":21,"props":37,"children":38},{},[],{"type":20,"tag":40,"props":41,"children":43},"h2",{"id":42},"framing-the-problem",[44],{"type":30,"value":45},"Framing the problem",{"type":20,"tag":32,"props":47,"children":48},{},[49],{"type":20,"tag":50,"props":51,"children":55},"a",{"href":52,"rel":53},"https://github.com/MrThygesen16/tf-aci-secret-inject",[54],"nofollow",[56],{"type":30,"value":57},"Full code can be found here.",{"type":20,"tag":32,"props":59,"children":60},{},[61],{"type":30,"value":62},"When creating Container Instances in Azure, it is recommended to provision a Managed Identity alongside the Container Instance. We can use this Managed Identity to generate an Entra ID token & use that for Authentication. A prime example would be provisioning Container Instances for privately hosted Azure DevOps agents.",{"type":20,"tag":32,"props":64,"children":65},{},[66,68,75],{"type":30,"value":67},"The benefits of this approach means we don't have to worry about handling secrets; no need for a key-vault or secure variables in Azure DevOps. More importantly, this means we are not writing any secrets to State in Terraform. Writing secrets directly to state leads to a problem called ",{"type":20,"tag":50,"props":69,"children":72},{"href":70,"rel":71},"https://www.hashicorp.com/en/resources/what-is-secret-sprawl-why-is-it-harmful",[54],[73],{"type":30,"value":74},"\"Secret Sprawl\"",{"type":30,"value":76},":",{"type":20,"tag":78,"props":79,"children":80},"blockquote",{},[81],{"type":20,"tag":32,"props":82,"children":83},{},[84],{"type":30,"value":85},"Secret Sprawl is the uncontrolled and unmanaged proliferation of sensitive information like API keys, passwords, and encryption keys across an organization's digital environment. This happens when these secrets are scattered across various systems, applications, and even unsecured communication channels without proper tracking or control.",{"type":20,"tag":32,"props":87,"children":88},{},[89],{"type":30,"value":90},"The above solution works well when using a Linux-based container image. For Windows Containers however, it is a different story.",{"type":20,"tag":32,"props":92,"children":93},{},[94],{"type":20,"tag":50,"props":95,"children":98},{"href":96,"rel":97},"https://learn.microsoft.com/en-us/azure/container-instances/container-instances-managed-identity#managed-identity-on-windows-containers",[54],[99],{"type":30,"value":100},"Microsoft Documentation on Container Instances highlights this issue:",{"type":20,"tag":78,"props":102,"children":103},{},[104],{"type":20,"tag":32,"props":105,"children":106},{},[107,109,115],{"type":30,"value":108},"Managed Identity on Windows container groups works differently than Linux container groups. ",{"type":20,"tag":110,"props":111,"children":112},"strong",{},[113],{"type":30,"value":114},"For Windows containers, metadata server (169.254.169.254) is not available for getting the Microsoft Entra ID token",{"type":30,"value":116},".",{"type":20,"tag":32,"props":118,"children":119},{},[120],{"type":30,"value":121},"The docs further state:",{"type":20,"tag":78,"props":123,"children":124},{},[125],{"type":20,"tag":32,"props":126,"children":127},{},[128],{"type":20,"tag":110,"props":129,"children":130},{},[131],{"type":30,"value":132},"Az Login module and other client libraries which depend on metadata server (169.254.169.254) will not work in a Windows Container. Additionally, Windows containers in vNet won't be able to connect to the endpoint; hence, a managed identity token can't be generated in a Windows virtual network container.",{"type":20,"tag":32,"props":134,"children":135},{},[136],{"type":30,"value":137},"Essentially, doing the approach described above (using a managed identity to create an Entra ID token) is not possible.",{"type":20,"tag":32,"props":139,"children":140},{},[141],{"type":30,"value":142},"Let's take the following Terraform snippet(s) as an example:",{"type":20,"tag":144,"props":145,"children":146},"ol",{},[147],{"type":20,"tag":148,"props":149,"children":150},"li",{},[151],{"type":30,"value":152},"First we will create a resource group",{"type":20,"tag":154,"props":155,"children":160},"code",{"className":156,"code":158,"language":159,"meta":12},[157],"language-terraform","# main.tf\nresource \"azurerm_resource_group\" \"this\" {\n  name     = \"rg-acg-example-01\"\n  location = \"AustraliaEast\"\n}\n\n","terraform",[161],{"type":20,"tag":162,"props":163,"children":164},"pre",{},[165],{"type":20,"tag":154,"props":166,"children":167},{"__ignoreMap":12},[168,179,188,197,206],{"type":20,"tag":169,"props":170,"children":173},"span",{"class":171,"line":172},"line",1,[174],{"type":20,"tag":169,"props":175,"children":176},{},[177],{"type":30,"value":178},"# main.tf\n",{"type":20,"tag":169,"props":180,"children":182},{"class":171,"line":181},2,[183],{"type":20,"tag":169,"props":184,"children":185},{},[186],{"type":30,"value":187},"resource \"azurerm_resource_group\" \"this\" {\n",{"type":20,"tag":169,"props":189,"children":191},{"class":171,"line":190},3,[192],{"type":20,"tag":169,"props":193,"children":194},{},[195],{"type":30,"value":196},"  name     = \"rg-acg-example-01\"\n",{"type":20,"tag":169,"props":198,"children":200},{"class":171,"line":199},4,[201],{"type":20,"tag":169,"props":202,"children":203},{},[204],{"type":30,"value":205},"  location = \"AustraliaEast\"\n",{"type":20,"tag":169,"props":207,"children":209},{"class":171,"line":208},5,[210],{"type":20,"tag":169,"props":211,"children":212},{},[213],{"type":30,"value":214},"}",{"type":20,"tag":144,"props":216,"children":217},{"start":181},[218],{"type":20,"tag":148,"props":219,"children":220},{},[221],{"type":30,"value":222},"Create a container group",{"type":20,"tag":154,"props":224,"children":227},{"className":225,"code":226,"language":159,"meta":12},[157],"# main.tf (cont.) - Insecure Windows Container Group\nresource \"azurerm_container_group\" \"unsecure\" {\n  name                = \"acg-windows-insecure-01\"\n  location            = azurerm_resource_group.this.location\n  resource_group_name = azurerm_resource_group.this.name\n  os_type             = \"Windows\"\n\n  container {\n    name   = \"aci-win-02\"\n    image  = \"mcr.microsoft.com/windows/servercore:ltsc2022\"\n    cpu    = \"0.5\"\n    memory = \"0.5\"\n\n    ports {\n      port     = \"22\"\n      protocol = \"TCP\"\n    }\n\n    commands = []\n    \n    ## secrets added to state\n    environment_variables = { \n        \"non_secure_var\" = \"NonSecureValueExposed\" \n    }\n    # Would be better to pass this in as a variable\n    # but for the sake of this demo -- this is simpler\n    secure_environment_variables = { \n        \"secure_var\" = \"SecureValueExposed\" \n    }\n  }\n}\n",[228],{"type":20,"tag":162,"props":229,"children":230},{},[231],{"type":20,"tag":154,"props":232,"children":233},{"__ignoreMap":12},[234,242,250,258,266,274,283,292,301,310,319,328,337,345,354,363,372,381,389,398,407,416,425,434,442,451,460,469,478,486,495],{"type":20,"tag":169,"props":235,"children":236},{"class":171,"line":172},[237],{"type":20,"tag":169,"props":238,"children":239},{},[240],{"type":30,"value":241},"# main.tf (cont.) - Insecure Windows Container Group\n",{"type":20,"tag":169,"props":243,"children":244},{"class":171,"line":181},[245],{"type":20,"tag":169,"props":246,"children":247},{},[248],{"type":30,"value":249},"resource \"azurerm_container_group\" \"unsecure\" {\n",{"type":20,"tag":169,"props":251,"children":252},{"class":171,"line":190},[253],{"type":20,"tag":169,"props":254,"children":255},{},[256],{"type":30,"value":257},"  name                = \"acg-windows-insecure-01\"\n",{"type":20,"tag":169,"props":259,"children":260},{"class":171,"line":199},[261],{"type":20,"tag":169,"props":262,"children":263},{},[264],{"type":30,"value":265},"  location            = azurerm_resource_group.this.location\n",{"type":20,"tag":169,"props":267,"children":268},{"class":171,"line":208},[269],{"type":20,"tag":169,"props":270,"children":271},{},[272],{"type":30,"value":273},"  resource_group_name = azurerm_resource_group.this.name\n",{"type":20,"tag":169,"props":275,"children":277},{"class":171,"line":276},6,[278],{"type":20,"tag":169,"props":279,"children":280},{},[281],{"type":30,"value":282},"  os_type             = \"Windows\"\n",{"type":20,"tag":169,"props":284,"children":286},{"class":171,"line":285},7,[287],{"type":20,"tag":169,"props":288,"children":289},{},[290],{"type":30,"value":291},"\n",{"type":20,"tag":169,"props":293,"children":295},{"class":171,"line":294},8,[296],{"type":20,"tag":169,"props":297,"children":298},{},[299],{"type":30,"value":300},"  container {\n",{"type":20,"tag":169,"props":302,"children":304},{"class":171,"line":303},9,[305],{"type":20,"tag":169,"props":306,"children":307},{},[308],{"type":30,"value":309},"    name   = \"aci-win-02\"\n",{"type":20,"tag":169,"props":311,"children":313},{"class":171,"line":312},10,[314],{"type":20,"tag":169,"props":315,"children":316},{},[317],{"type":30,"value":318},"    image  = \"mcr.microsoft.com/windows/servercore:ltsc2022\"\n",{"type":20,"tag":169,"props":320,"children":322},{"class":171,"line":321},11,[323],{"type":20,"tag":169,"props":324,"children":325},{},[326],{"type":30,"value":327},"    cpu    = \"0.5\"\n",{"type":20,"tag":169,"props":329,"children":331},{"class":171,"line":330},12,[332],{"type":20,"tag":169,"props":333,"children":334},{},[335],{"type":30,"value":336},"    memory = \"0.5\"\n",{"type":20,"tag":169,"props":338,"children":340},{"class":171,"line":339},13,[341],{"type":20,"tag":169,"props":342,"children":343},{},[344],{"type":30,"value":291},{"type":20,"tag":169,"props":346,"children":348},{"class":171,"line":347},14,[349],{"type":20,"tag":169,"props":350,"children":351},{},[352],{"type":30,"value":353},"    ports {\n",{"type":20,"tag":169,"props":355,"children":357},{"class":171,"line":356},15,[358],{"type":20,"tag":169,"props":359,"children":360},{},[361],{"type":30,"value":362},"      port     = \"22\"\n",{"type":20,"tag":169,"props":364,"children":366},{"class":171,"line":365},16,[367],{"type":20,"tag":169,"props":368,"children":369},{},[370],{"type":30,"value":371},"      protocol = \"TCP\"\n",{"type":20,"tag":169,"props":373,"children":375},{"class":171,"line":374},17,[376],{"type":20,"tag":169,"props":377,"children":378},{},[379],{"type":30,"value":380},"    }\n",{"type":20,"tag":169,"props":382,"children":384},{"class":171,"line":383},18,[385],{"type":20,"tag":169,"props":386,"children":387},{},[388],{"type":30,"value":291},{"type":20,"tag":169,"props":390,"children":392},{"class":171,"line":391},19,[393],{"type":20,"tag":169,"props":394,"children":395},{},[396],{"type":30,"value":397},"    commands = []\n",{"type":20,"tag":169,"props":399,"children":401},{"class":171,"line":400},20,[402],{"type":20,"tag":169,"props":403,"children":404},{},[405],{"type":30,"value":406},"    \n",{"type":20,"tag":169,"props":408,"children":410},{"class":171,"line":409},21,[411],{"type":20,"tag":169,"props":412,"children":413},{},[414],{"type":30,"value":415},"    ## secrets added to state\n",{"type":20,"tag":169,"props":417,"children":419},{"class":171,"line":418},22,[420],{"type":20,"tag":169,"props":421,"children":422},{},[423],{"type":30,"value":424},"    environment_variables = { \n",{"type":20,"tag":169,"props":426,"children":428},{"class":171,"line":427},23,[429],{"type":20,"tag":169,"props":430,"children":431},{},[432],{"type":30,"value":433},"        \"non_secure_var\" = \"NonSecureValueExposed\" \n",{"type":20,"tag":169,"props":435,"children":437},{"class":171,"line":436},24,[438],{"type":20,"tag":169,"props":439,"children":440},{},[441],{"type":30,"value":380},{"type":20,"tag":169,"props":443,"children":445},{"class":171,"line":444},25,[446],{"type":20,"tag":169,"props":447,"children":448},{},[449],{"type":30,"value":450},"    # Would be better to pass this in as a variable\n",{"type":20,"tag":169,"props":452,"children":454},{"class":171,"line":453},26,[455],{"type":20,"tag":169,"props":456,"children":457},{},[458],{"type":30,"value":459},"    # but for the sake of this demo -- this is simpler\n",{"type":20,"tag":169,"props":461,"children":463},{"class":171,"line":462},27,[464],{"type":20,"tag":169,"props":465,"children":466},{},[467],{"type":30,"value":468},"    secure_environment_variables = { \n",{"type":20,"tag":169,"props":470,"children":472},{"class":171,"line":471},28,[473],{"type":20,"tag":169,"props":474,"children":475},{},[476],{"type":30,"value":477},"        \"secure_var\" = \"SecureValueExposed\" \n",{"type":20,"tag":169,"props":479,"children":481},{"class":171,"line":480},29,[482],{"type":20,"tag":169,"props":483,"children":484},{},[485],{"type":30,"value":380},{"type":20,"tag":169,"props":487,"children":489},{"class":171,"line":488},30,[490],{"type":20,"tag":169,"props":491,"children":492},{},[493],{"type":30,"value":494},"  }\n",{"type":20,"tag":169,"props":496,"children":498},{"class":171,"line":497},31,[499],{"type":20,"tag":169,"props":500,"children":501},{},[502],{"type":30,"value":214},{"type":20,"tag":32,"props":504,"children":505},{},[506,508,514],{"type":30,"value":507},"We can check the Azure portal and confirm that our two environment variables have been added to the Container.\nFurthermore, notice that Azure does not display the value of the environment variable ",{"type":20,"tag":509,"props":510,"children":511},"code-inline",{},[512],{"type":30,"value":513},"secure_var",{"type":30,"value":116},{"type":20,"tag":516,"props":517,"children":518},"table",{},[519,539],{"type":20,"tag":520,"props":521,"children":522},"thead",{},[523],{"type":20,"tag":524,"props":525,"children":526},"tr",{},[527,534],{"type":20,"tag":528,"props":529,"children":531},"th",{"align":530},null,[532],{"type":30,"value":533},"Key",{"type":20,"tag":528,"props":535,"children":536},{"align":530},[537],{"type":30,"value":538},"Value",{"type":20,"tag":540,"props":541,"children":542},"tbody",{},[543,557],{"type":20,"tag":524,"props":544,"children":545},{},[546,552],{"type":20,"tag":547,"props":548,"children":549},"td",{"align":530},[550],{"type":30,"value":551},"non_secure_var",{"type":20,"tag":547,"props":553,"children":554},{"align":530},[555],{"type":30,"value":556},"NonSecureValue",{"type":20,"tag":524,"props":558,"children":559},{},[560,564],{"type":20,"tag":547,"props":561,"children":562},{"align":530},[563],{"type":30,"value":513},{"type":20,"tag":547,"props":565,"children":566},{"align":530},[],{"type":20,"tag":32,"props":568,"children":569},{},[570],{"type":30,"value":571},"However, when we look at our State file, we can see that the secrets - including the secure variable is stored in plain-text.",{"type":20,"tag":154,"props":573,"children":578},{"className":574,"code":576,"language":577,"meta":12},[575],"language-json","// terraform.tfstate\n\"environment_variables\": {\n    \"non_secure_var\": \"NonSecureValue\"\n},\n\"secure_environment_variables\": {\n    \"secure_var\": \"SecureValue\"\n},\n","json",[579],{"type":20,"tag":162,"props":580,"children":581},{},[582],{"type":20,"tag":154,"props":583,"children":584},{"__ignoreMap":12},[585,594,609,633,641,653,674],{"type":20,"tag":169,"props":586,"children":587},{"class":171,"line":172},[588],{"type":20,"tag":169,"props":589,"children":591},{"class":590},"ct-128513",[592],{"type":30,"value":593},"// terraform.tfstate\n",{"type":20,"tag":169,"props":595,"children":596},{"class":171,"line":181},[597,603],{"type":20,"tag":169,"props":598,"children":600},{"class":599},"ct-667011",[601],{"type":30,"value":602},"\"environment_variables\"",{"type":20,"tag":169,"props":604,"children":606},{"class":605},"ct-935781",[607],{"type":30,"value":608},": {\n",{"type":20,"tag":169,"props":610,"children":611},{"class":171,"line":190},[612,617,623,628],{"type":20,"tag":169,"props":613,"children":614},{"class":605},[615],{"type":30,"value":616},"    ",{"type":20,"tag":169,"props":618,"children":620},{"class":619},"ct-238295",[621],{"type":30,"value":622},"\"non_secure_var\"",{"type":20,"tag":169,"props":624,"children":625},{"class":605},[626],{"type":30,"value":627},": ",{"type":20,"tag":169,"props":629,"children":630},{"class":599},[631],{"type":30,"value":632},"\"NonSecureValue\"\n",{"type":20,"tag":169,"props":634,"children":635},{"class":171,"line":199},[636],{"type":20,"tag":169,"props":637,"children":638},{"class":605},[639],{"type":30,"value":640},"},\n",{"type":20,"tag":169,"props":642,"children":643},{"class":171,"line":208},[644,649],{"type":20,"tag":169,"props":645,"children":646},{"class":599},[647],{"type":30,"value":648},"\"secure_environment_variables\"",{"type":20,"tag":169,"props":650,"children":651},{"class":605},[652],{"type":30,"value":608},{"type":20,"tag":169,"props":654,"children":655},{"class":171,"line":276},[656,660,665,669],{"type":20,"tag":169,"props":657,"children":658},{"class":605},[659],{"type":30,"value":616},{"type":20,"tag":169,"props":661,"children":662},{"class":619},[663],{"type":30,"value":664},"\"secure_var\"",{"type":20,"tag":169,"props":666,"children":667},{"class":605},[668],{"type":30,"value":627},{"type":20,"tag":169,"props":670,"children":671},{"class":599},[672],{"type":30,"value":673},"\"SecureValue\"\n",{"type":20,"tag":169,"props":675,"children":676},{"class":171,"line":285},[677],{"type":20,"tag":169,"props":678,"children":679},{"class":605},[680],{"type":30,"value":681},"},",{"type":20,"tag":32,"props":683,"children":684},{},[685],{"type":30,"value":686},"Unfortunately, this means that anyone who has read-access to state can view these secrets.",{"type":20,"tag":40,"props":688,"children":690},{"id":689},"solution",[691],{"type":30,"value":692},"Solution",{"type":20,"tag":32,"props":694,"children":695},{},[696],{"type":30,"value":697},"We can solve this issue by using AzAPI.",{"type":20,"tag":144,"props":699,"children":700},{},[701],{"type":20,"tag":148,"props":702,"children":703},{},[704],{"type":30,"value":705},"Create another Container group; this time we don't add the secrets in, and instead add a lifecycle ignore block on the environment variables object (otherwise Terraform will complain)",{"type":20,"tag":154,"props":707,"children":710},{"className":708,"code":709,"language":159,"meta":12},[157],"# main.tf (cont.) Secure Windows Container Group\nresource \"azurerm_container_group\" \"secure\" {\n  name                = \"acg-windows-secure-01\"\n  location            = azurerm_resource_group.this.location\n  resource_group_name = azurerm_resource_group.this.name\n  os_type             = \"Windows\"\n\n  container {\n    name   = \"aci-win-01\"\n    image  = \"mcr.microsoft.com/windows/servercore:ltsc2022\"\n    cpu    = \"0.5\"\n    memory = \"0.5\"\n\n    ports {\n      port     = \"22\"\n      protocol = \"TCP\"\n    }\n\n    ## let azapi inject these secrets\n    # commands = []\n    # environment_variables = {}\n  }\n\n  lifecycle {\n    ignore_changes = [\n      container[0].environment_variables,\n      container[0].commands,\n    ]\n  }\n}\n",[711],{"type":20,"tag":162,"props":712,"children":713},{},[714],{"type":20,"tag":154,"props":715,"children":716},{"__ignoreMap":12},[717,725,733,741,748,755,762,769,776,784,791,798,805,812,819,826,833,840,847,855,863,871,878,885,893,901,909,917,925,932],{"type":20,"tag":169,"props":718,"children":719},{"class":171,"line":172},[720],{"type":20,"tag":169,"props":721,"children":722},{},[723],{"type":30,"value":724},"# main.tf (cont.) Secure Windows Container Group\n",{"type":20,"tag":169,"props":726,"children":727},{"class":171,"line":181},[728],{"type":20,"tag":169,"props":729,"children":730},{},[731],{"type":30,"value":732},"resource \"azurerm_container_group\" \"secure\" {\n",{"type":20,"tag":169,"props":734,"children":735},{"class":171,"line":190},[736],{"type":20,"tag":169,"props":737,"children":738},{},[739],{"type":30,"value":740},"  name                = \"acg-windows-secure-01\"\n",{"type":20,"tag":169,"props":742,"children":743},{"class":171,"line":199},[744],{"type":20,"tag":169,"props":745,"children":746},{},[747],{"type":30,"value":265},{"type":20,"tag":169,"props":749,"children":750},{"class":171,"line":208},[751],{"type":20,"tag":169,"props":752,"children":753},{},[754],{"type":30,"value":273},{"type":20,"tag":169,"props":756,"children":757},{"class":171,"line":276},[758],{"type":20,"tag":169,"props":759,"children":760},{},[761],{"type":30,"value":282},{"type":20,"tag":169,"props":763,"children":764},{"class":171,"line":285},[765],{"type":20,"tag":169,"props":766,"children":767},{},[768],{"type":30,"value":291},{"type":20,"tag":169,"props":770,"children":771},{"class":171,"line":294},[772],{"type":20,"tag":169,"props":773,"children":774},{},[775],{"type":30,"value":300},{"type":20,"tag":169,"props":777,"children":778},{"class":171,"line":303},[779],{"type":20,"tag":169,"props":780,"children":781},{},[782],{"type":30,"value":783},"    name   = \"aci-win-01\"\n",{"type":20,"tag":169,"props":785,"children":786},{"class":171,"line":312},[787],{"type":20,"tag":169,"props":788,"children":789},{},[790],{"type":30,"value":318},{"type":20,"tag":169,"props":792,"children":793},{"class":171,"line":321},[794],{"type":20,"tag":169,"props":795,"children":796},{},[797],{"type":30,"value":327},{"type":20,"tag":169,"props":799,"children":800},{"class":171,"line":330},[801],{"type":20,"tag":169,"props":802,"children":803},{},[804],{"type":30,"value":336},{"type":20,"tag":169,"props":806,"children":807},{"class":171,"line":339},[808],{"type":20,"tag":169,"props":809,"children":810},{},[811],{"type":30,"value":291},{"type":20,"tag":169,"props":813,"children":814},{"class":171,"line":347},[815],{"type":20,"tag":169,"props":816,"children":817},{},[818],{"type":30,"value":353},{"type":20,"tag":169,"props":820,"children":821},{"class":171,"line":356},[822],{"type":20,"tag":169,"props":823,"children":824},{},[825],{"type":30,"value":362},{"type":20,"tag":169,"props":827,"children":828},{"class":171,"line":365},[829],{"type":20,"tag":169,"props":830,"children":831},{},[832],{"type":30,"value":371},{"type":20,"tag":169,"props":834,"children":835},{"class":171,"line":374},[836],{"type":20,"tag":169,"props":837,"children":838},{},[839],{"type":30,"value":380},{"type":20,"tag":169,"props":841,"children":842},{"class":171,"line":383},[843],{"type":20,"tag":169,"props":844,"children":845},{},[846],{"type":30,"value":291},{"type":20,"tag":169,"props":848,"children":849},{"class":171,"line":391},[850],{"type":20,"tag":169,"props":851,"children":852},{},[853],{"type":30,"value":854},"    ## let azapi inject these secrets\n",{"type":20,"tag":169,"props":856,"children":857},{"class":171,"line":400},[858],{"type":20,"tag":169,"props":859,"children":860},{},[861],{"type":30,"value":862},"    # commands = []\n",{"type":20,"tag":169,"props":864,"children":865},{"class":171,"line":409},[866],{"type":20,"tag":169,"props":867,"children":868},{},[869],{"type":30,"value":870},"    # environment_variables = {}\n",{"type":20,"tag":169,"props":872,"children":873},{"class":171,"line":418},[874],{"type":20,"tag":169,"props":875,"children":876},{},[877],{"type":30,"value":494},{"type":20,"tag":169,"props":879,"children":880},{"class":171,"line":427},[881],{"type":20,"tag":169,"props":882,"children":883},{},[884],{"type":30,"value":291},{"type":20,"tag":169,"props":886,"children":887},{"class":171,"line":436},[888],{"type":20,"tag":169,"props":889,"children":890},{},[891],{"type":30,"value":892},"  lifecycle {\n",{"type":20,"tag":169,"props":894,"children":895},{"class":171,"line":444},[896],{"type":20,"tag":169,"props":897,"children":898},{},[899],{"type":30,"value":900},"    ignore_changes = [\n",{"type":20,"tag":169,"props":902,"children":903},{"class":171,"line":453},[904],{"type":20,"tag":169,"props":905,"children":906},{},[907],{"type":30,"value":908},"      container[0].environment_variables,\n",{"type":20,"tag":169,"props":910,"children":911},{"class":171,"line":462},[912],{"type":20,"tag":169,"props":913,"children":914},{},[915],{"type":30,"value":916},"      container[0].commands,\n",{"type":20,"tag":169,"props":918,"children":919},{"class":171,"line":471},[920],{"type":20,"tag":169,"props":921,"children":922},{},[923],{"type":30,"value":924},"    ]\n",{"type":20,"tag":169,"props":926,"children":927},{"class":171,"line":480},[928],{"type":20,"tag":169,"props":929,"children":930},{},[931],{"type":30,"value":494},{"type":20,"tag":169,"props":933,"children":934},{"class":171,"line":488},[935],{"type":20,"tag":169,"props":936,"children":937},{},[938],{"type":30,"value":214},{"type":20,"tag":144,"props":940,"children":941},{"start":181},[942],{"type":20,"tag":148,"props":943,"children":944},{},[945],{"type":30,"value":946},"Next we use AzAPI to Stop the container by sending a POST request to the Container Group",{"type":20,"tag":154,"props":948,"children":951},{"className":949,"code":950,"language":159,"meta":12},[157],"# main.tf (cont.) stop container group\nresource \"azapi_resource_action\" \"stop_container_group\" {\n  type        = \"Microsoft.ContainerInstance/containerGroups@2023-05-01\"\n  resource_id = azurerm_container_group.secure.id\n  action      = \"stop\"\n  method      = \"POST\"\n}\n",[952],{"type":20,"tag":162,"props":953,"children":954},{},[955],{"type":20,"tag":154,"props":956,"children":957},{"__ignoreMap":12},[958,966,974,982,990,998,1006],{"type":20,"tag":169,"props":959,"children":960},{"class":171,"line":172},[961],{"type":20,"tag":169,"props":962,"children":963},{},[964],{"type":30,"value":965},"# main.tf (cont.) stop container group\n",{"type":20,"tag":169,"props":967,"children":968},{"class":171,"line":181},[969],{"type":20,"tag":169,"props":970,"children":971},{},[972],{"type":30,"value":973},"resource \"azapi_resource_action\" \"stop_container_group\" {\n",{"type":20,"tag":169,"props":975,"children":976},{"class":171,"line":190},[977],{"type":20,"tag":169,"props":978,"children":979},{},[980],{"type":30,"value":981},"  type        = \"Microsoft.ContainerInstance/containerGroups@2023-05-01\"\n",{"type":20,"tag":169,"props":983,"children":984},{"class":171,"line":199},[985],{"type":20,"tag":169,"props":986,"children":987},{},[988],{"type":30,"value":989},"  resource_id = azurerm_container_group.secure.id\n",{"type":20,"tag":169,"props":991,"children":992},{"class":171,"line":208},[993],{"type":20,"tag":169,"props":994,"children":995},{},[996],{"type":30,"value":997},"  action      = \"stop\"\n",{"type":20,"tag":169,"props":999,"children":1000},{"class":171,"line":276},[1001],{"type":20,"tag":169,"props":1002,"children":1003},{},[1004],{"type":30,"value":1005},"  method      = \"POST\"\n",{"type":20,"tag":169,"props":1007,"children":1008},{"class":171,"line":285},[1009],{"type":20,"tag":169,"props":1010,"children":1011},{},[1012],{"type":30,"value":214},{"type":20,"tag":144,"props":1014,"children":1015},{"start":190},[1016],{"type":20,"tag":148,"props":1017,"children":1018},{},[1019,1021,1026],{"type":30,"value":1020},"Also using AzAPI, we use the resource ",{"type":20,"tag":509,"props":1022,"children":1023},{},[1024],{"type":30,"value":1025},"update_resource",{"type":30,"value":1027}," to inject the variables.",{"type":20,"tag":154,"props":1029,"children":1032},{"className":1030,"code":1031,"language":159,"meta":12},[157],"# main.tf (cont.) inject secrets\nresource \"azapi_update_resource\" \"inject_secrets\" {\n  type        = \"Microsoft.ContainerInstance/containerGroups@2023-05-01\"\n  resource_id = azurerm_container_group.secure.id\n  \n  # rather than using `body`, we use `sensitive_body`\n  sensitive_body = {\n    properties = {\n      containers = [\n        {\n          name = azurerm_container_group.secure.container[0].name\n          properties = {\n            environmentVariables = [\n              {\n                name  = \"non_secure_var\"\n                value = \"NonSecureValueHidden\"\n              },\n              {\n                name        = \"secure_var\"\n                secureValue = \"SecureValueHidden\"\n              }\n            ]\n          }\n        }\n      ]\n    }\n  }\n}\n",[1033],{"type":20,"tag":162,"props":1034,"children":1035},{},[1036],{"type":20,"tag":154,"props":1037,"children":1038},{"__ignoreMap":12},[1039,1047,1055,1062,1069,1077,1085,1093,1101,1109,1117,1125,1133,1141,1149,1157,1165,1173,1180,1188,1196,1204,1212,1220,1228,1236,1243,1250],{"type":20,"tag":169,"props":1040,"children":1041},{"class":171,"line":172},[1042],{"type":20,"tag":169,"props":1043,"children":1044},{},[1045],{"type":30,"value":1046},"# main.tf (cont.) inject secrets\n",{"type":20,"tag":169,"props":1048,"children":1049},{"class":171,"line":181},[1050],{"type":20,"tag":169,"props":1051,"children":1052},{},[1053],{"type":30,"value":1054},"resource \"azapi_update_resource\" \"inject_secrets\" {\n",{"type":20,"tag":169,"props":1056,"children":1057},{"class":171,"line":190},[1058],{"type":20,"tag":169,"props":1059,"children":1060},{},[1061],{"type":30,"value":981},{"type":20,"tag":169,"props":1063,"children":1064},{"class":171,"line":199},[1065],{"type":20,"tag":169,"props":1066,"children":1067},{},[1068],{"type":30,"value":989},{"type":20,"tag":169,"props":1070,"children":1071},{"class":171,"line":208},[1072],{"type":20,"tag":169,"props":1073,"children":1074},{},[1075],{"type":30,"value":1076},"  \n",{"type":20,"tag":169,"props":1078,"children":1079},{"class":171,"line":276},[1080],{"type":20,"tag":169,"props":1081,"children":1082},{},[1083],{"type":30,"value":1084},"  # rather than using `body`, we use `sensitive_body`\n",{"type":20,"tag":169,"props":1086,"children":1087},{"class":171,"line":285},[1088],{"type":20,"tag":169,"props":1089,"children":1090},{},[1091],{"type":30,"value":1092},"  sensitive_body = {\n",{"type":20,"tag":169,"props":1094,"children":1095},{"class":171,"line":294},[1096],{"type":20,"tag":169,"props":1097,"children":1098},{},[1099],{"type":30,"value":1100},"    properties = {\n",{"type":20,"tag":169,"props":1102,"children":1103},{"class":171,"line":303},[1104],{"type":20,"tag":169,"props":1105,"children":1106},{},[1107],{"type":30,"value":1108},"      containers = [\n",{"type":20,"tag":169,"props":1110,"children":1111},{"class":171,"line":312},[1112],{"type":20,"tag":169,"props":1113,"children":1114},{},[1115],{"type":30,"value":1116},"        {\n",{"type":20,"tag":169,"props":1118,"children":1119},{"class":171,"line":321},[1120],{"type":20,"tag":169,"props":1121,"children":1122},{},[1123],{"type":30,"value":1124},"          name = azurerm_container_group.secure.container[0].name\n",{"type":20,"tag":169,"props":1126,"children":1127},{"class":171,"line":330},[1128],{"type":20,"tag":169,"props":1129,"children":1130},{},[1131],{"type":30,"value":1132},"          properties = {\n",{"type":20,"tag":169,"props":1134,"children":1135},{"class":171,"line":339},[1136],{"type":20,"tag":169,"props":1137,"children":1138},{},[1139],{"type":30,"value":1140},"            environmentVariables = [\n",{"type":20,"tag":169,"props":1142,"children":1143},{"class":171,"line":347},[1144],{"type":20,"tag":169,"props":1145,"children":1146},{},[1147],{"type":30,"value":1148},"              {\n",{"type":20,"tag":169,"props":1150,"children":1151},{"class":171,"line":356},[1152],{"type":20,"tag":169,"props":1153,"children":1154},{},[1155],{"type":30,"value":1156},"                name  = \"non_secure_var\"\n",{"type":20,"tag":169,"props":1158,"children":1159},{"class":171,"line":365},[1160],{"type":20,"tag":169,"props":1161,"children":1162},{},[1163],{"type":30,"value":1164},"                value = \"NonSecureValueHidden\"\n",{"type":20,"tag":169,"props":1166,"children":1167},{"class":171,"line":374},[1168],{"type":20,"tag":169,"props":1169,"children":1170},{},[1171],{"type":30,"value":1172},"              },\n",{"type":20,"tag":169,"props":1174,"children":1175},{"class":171,"line":383},[1176],{"type":20,"tag":169,"props":1177,"children":1178},{},[1179],{"type":30,"value":1148},{"type":20,"tag":169,"props":1181,"children":1182},{"class":171,"line":391},[1183],{"type":20,"tag":169,"props":1184,"children":1185},{},[1186],{"type":30,"value":1187},"                name        = \"secure_var\"\n",{"type":20,"tag":169,"props":1189,"children":1190},{"class":171,"line":400},[1191],{"type":20,"tag":169,"props":1192,"children":1193},{},[1194],{"type":30,"value":1195},"                secureValue = \"SecureValueHidden\"\n",{"type":20,"tag":169,"props":1197,"children":1198},{"class":171,"line":409},[1199],{"type":20,"tag":169,"props":1200,"children":1201},{},[1202],{"type":30,"value":1203},"              }\n",{"type":20,"tag":169,"props":1205,"children":1206},{"class":171,"line":418},[1207],{"type":20,"tag":169,"props":1208,"children":1209},{},[1210],{"type":30,"value":1211},"            ]\n",{"type":20,"tag":169,"props":1213,"children":1214},{"class":171,"line":427},[1215],{"type":20,"tag":169,"props":1216,"children":1217},{},[1218],{"type":30,"value":1219},"          }\n",{"type":20,"tag":169,"props":1221,"children":1222},{"class":171,"line":436},[1223],{"type":20,"tag":169,"props":1224,"children":1225},{},[1226],{"type":30,"value":1227},"        }\n",{"type":20,"tag":169,"props":1229,"children":1230},{"class":171,"line":444},[1231],{"type":20,"tag":169,"props":1232,"children":1233},{},[1234],{"type":30,"value":1235},"      ]\n",{"type":20,"tag":169,"props":1237,"children":1238},{"class":171,"line":453},[1239],{"type":20,"tag":169,"props":1240,"children":1241},{},[1242],{"type":30,"value":380},{"type":20,"tag":169,"props":1244,"children":1245},{"class":171,"line":462},[1246],{"type":20,"tag":169,"props":1247,"children":1248},{},[1249],{"type":30,"value":494},{"type":20,"tag":169,"props":1251,"children":1252},{"class":171,"line":471},[1253],{"type":20,"tag":169,"props":1254,"children":1255},{},[1256],{"type":30,"value":214},{"type":20,"tag":32,"props":1258,"children":1259},{},[1260,1262,1269],{"type":30,"value":1261},"The reason we are able to update these values and not have them written to state is due to the introduction of ",{"type":20,"tag":50,"props":1263,"children":1266},{"href":1264,"rel":1265},"https://registry.terraform.io/providers/Azure/azapi/latest/docs/guides/feature_ephemeral_resource#write-only-attributes",[54],[1267],{"type":30,"value":1268},"\"Ephemeral Resources & Write-Only Attributes in Terraform\"",{"type":30,"value":76},{"type":20,"tag":78,"props":1271,"children":1272},{},[1273,1278],{"type":20,"tag":32,"props":1274,"children":1275},{},[1276],{"type":30,"value":1277},"Write-only arguments let you securely pass temporary values to Terraform's managed resources during an operation without persisting those values to state or plan files.",{"type":20,"tag":32,"props":1279,"children":1280},{},[1281],{"type":30,"value":1282},"The AzAPI provider supports sensitive_body to define attributes that are not stored in the state file, ensuring sensitive information remains secure",{"type":20,"tag":144,"props":1284,"children":1285},{"start":199},[1286],{"type":20,"tag":148,"props":1287,"children":1288},{},[1289],{"type":30,"value":1290},"Lastly, we start the container group again.",{"type":20,"tag":154,"props":1292,"children":1295},{"className":1293,"code":1294,"language":159,"meta":12},[157],"# main.tf (cont.) start container group\nresource \"azapi_resource_action\" \"start_container_group\" {\n  type        = \"Microsoft.ContainerInstance/containerGroups@2022-05-01\"\n  resource_id = azurerm_container_group.secure.id\n  action      = \"start\"\n  method      = \"POST\"\n\n  depends_on = [\n    azapi_update_resource.inject_secrets, \n    azapi_resource_action.stop_container_group\n  ]\n}\n",[1296],{"type":20,"tag":162,"props":1297,"children":1298},{},[1299],{"type":20,"tag":154,"props":1300,"children":1301},{"__ignoreMap":12},[1302,1310,1318,1326,1333,1341,1348,1355,1363,1371,1379,1387],{"type":20,"tag":169,"props":1303,"children":1304},{"class":171,"line":172},[1305],{"type":20,"tag":169,"props":1306,"children":1307},{},[1308],{"type":30,"value":1309},"# main.tf (cont.) start container group\n",{"type":20,"tag":169,"props":1311,"children":1312},{"class":171,"line":181},[1313],{"type":20,"tag":169,"props":1314,"children":1315},{},[1316],{"type":30,"value":1317},"resource \"azapi_resource_action\" \"start_container_group\" {\n",{"type":20,"tag":169,"props":1319,"children":1320},{"class":171,"line":190},[1321],{"type":20,"tag":169,"props":1322,"children":1323},{},[1324],{"type":30,"value":1325},"  type        = \"Microsoft.ContainerInstance/containerGroups@2022-05-01\"\n",{"type":20,"tag":169,"props":1327,"children":1328},{"class":171,"line":199},[1329],{"type":20,"tag":169,"props":1330,"children":1331},{},[1332],{"type":30,"value":989},{"type":20,"tag":169,"props":1334,"children":1335},{"class":171,"line":208},[1336],{"type":20,"tag":169,"props":1337,"children":1338},{},[1339],{"type":30,"value":1340},"  action      = \"start\"\n",{"type":20,"tag":169,"props":1342,"children":1343},{"class":171,"line":276},[1344],{"type":20,"tag":169,"props":1345,"children":1346},{},[1347],{"type":30,"value":1005},{"type":20,"tag":169,"props":1349,"children":1350},{"class":171,"line":285},[1351],{"type":20,"tag":169,"props":1352,"children":1353},{},[1354],{"type":30,"value":291},{"type":20,"tag":169,"props":1356,"children":1357},{"class":171,"line":294},[1358],{"type":20,"tag":169,"props":1359,"children":1360},{},[1361],{"type":30,"value":1362},"  depends_on = [\n",{"type":20,"tag":169,"props":1364,"children":1365},{"class":171,"line":303},[1366],{"type":20,"tag":169,"props":1367,"children":1368},{},[1369],{"type":30,"value":1370},"    azapi_update_resource.inject_secrets, \n",{"type":20,"tag":169,"props":1372,"children":1373},{"class":171,"line":312},[1374],{"type":20,"tag":169,"props":1375,"children":1376},{},[1377],{"type":30,"value":1378},"    azapi_resource_action.stop_container_group\n",{"type":20,"tag":169,"props":1380,"children":1381},{"class":171,"line":321},[1382],{"type":20,"tag":169,"props":1383,"children":1384},{},[1385],{"type":30,"value":1386},"  ]\n",{"type":20,"tag":169,"props":1388,"children":1389},{"class":171,"line":330},[1390],{"type":20,"tag":169,"props":1391,"children":1392},{},[1393],{"type":30,"value":214},{"type":20,"tag":32,"props":1395,"children":1396},{},[1397],{"type":30,"value":1398},"This is purely anecdotal, but I've found that stopping, injecting secrets, and then starting the container group yields more consistent results.",{"type":20,"tag":32,"props":1400,"children":1401},{},[1402],{"type":30,"value":1403},"Finally, when we take a look at the state file for the container where we injected the secrets, we can see that neither the non-secure, nor the secure environment variables have been written to state.",{"type":20,"tag":154,"props":1405,"children":1408},{"className":1406,"code":1407,"language":577,"meta":12},[575],"// terraforn.tfstate\n\"environment_variables\": null,\n\"secure_environment_variables\": null\n",[1409],{"type":20,"tag":162,"props":1410,"children":1411},{},[1412],{"type":20,"tag":154,"props":1413,"children":1414},{"__ignoreMap":12},[1415,1423,1445],{"type":20,"tag":169,"props":1416,"children":1417},{"class":171,"line":172},[1418],{"type":20,"tag":169,"props":1419,"children":1420},{"class":590},[1421],{"type":30,"value":1422},"// terraforn.tfstate\n",{"type":20,"tag":169,"props":1424,"children":1425},{"class":171,"line":181},[1426,1430,1434,1440],{"type":20,"tag":169,"props":1427,"children":1428},{"class":599},[1429],{"type":30,"value":602},{"type":20,"tag":169,"props":1431,"children":1432},{"class":605},[1433],{"type":30,"value":627},{"type":20,"tag":169,"props":1435,"children":1437},{"class":1436},"ct-998471",[1438],{"type":30,"value":1439},"null",{"type":20,"tag":169,"props":1441,"children":1442},{"class":605},[1443],{"type":30,"value":1444},",\n",{"type":20,"tag":169,"props":1446,"children":1447},{"class":171,"line":190},[1448,1452,1456],{"type":20,"tag":169,"props":1449,"children":1450},{"class":599},[1451],{"type":30,"value":648},{"type":20,"tag":169,"props":1453,"children":1454},{"class":605},[1455],{"type":30,"value":627},{"type":20,"tag":169,"props":1457,"children":1458},{"class":1436},[1459],{"type":30,"value":1439},{"type":20,"tag":1461,"children":1462},"style",[1463],{"type":30,"value":1464},".dark .ct-128513{color:#8B949E;}\n.ct-128513{color:#6E7781;}\n.dark .ct-667011{color:#A5D6FF;}\n.ct-667011{color:#0A3069;}\n.dark .ct-935781{color:#C9D1D9;}\n.ct-935781{color:#24292F;}\n.dark .ct-238295{color:#7EE787;}\n.ct-238295{color:#116329;}\n.dark .ct-998471{color:#79C0FF;}\n.ct-998471{color:#0550AE;}",{"title":12,"searchDepth":181,"depth":181,"links":1466},[1467,1468],{"id":42,"depth":181,"text":45},{"id":689,"depth":181,"text":692},"markdown","content:4.blog:secure-variable-injection.MD","content","4.blog/secure-variable-injection.MD","MD",{"/blog/secure-variable-injection":1475},[1476,530],{"_path":1477,"_dir":11,"_draft":7,"_partial":7,"_locale":12,"_empty":7,"title":1478,"description":12,"date":1479,"draft":6,"_type":1469,"_id":1480,"_source":1471,"_file":1481,"_extension":1482},"/blog/pace-user-manual","MQ PACE User Manual","2023/07/16","content:4.blog:6.pace-user-manual.md","4.blog/6.pace-user-manual.md","md",{},[1485,1488,1491],{"title":1486,"_path":1487},"Home","/",{"title":1489,"_path":1490},"About","/about",{"title":1492,"_path":1493,"children":1494},"Blog","/blog",[1495,1498,1501,1504,1507,1510,1511],{"title":1496,"_path":1497},"Hello, Blog!","/blog/first-blog",{"title":1499,"_path":1500,"layout":15},"Calculating nth Fibonacci Number in Linear Time","/blog/fib-dynamic",{"title":1502,"_path":1503,"layout":15},"Syntax Highlighting in Python","/blog/syntax-highlight-python",{"title":1505,"_path":1506},"Using Python & ChatGPT to webscrape","/blog/webscrape-chatgpt",{"title":1508,"_path":1509},"Learning programming & Mental Model","/blog/mental-model",{"title":1478,"_path":1477},{"title":13,"_path":10,"layout":15},{"fa-brands:github":1513,"ph:copy":1518},{"left":1514,"top":1514,"width":1515,"height":1516,"rotate":1514,"vFlip":7,"hFlip":7,"body":1517},0,496,512,"\u003Cpath fill=\"currentColor\" d=\"M165.9 397.4c0 2-2.3 3.6-5.2 3.6c-3.3.3-5.6-1.3-5.6-3.6c0-2 2.3-3.6 5.2-3.6c3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9c2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9c.3 2 2.9 3.3 5.9 2.6c2.9-.7 4.9-2.6 4.6-4.6c-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2c12.8 2.3 17.3-5.6 17.3-12.1c0-6.2-.3-40.4-.3-61.4c0 0-70 15-84.7-29.8c0 0-11.4-29.1-27.8-36.6c0 0-22.9-15.7 1.6-15.4c0 0 24.9 2 38.6 25.8c21.9 38.6 58.6 27.5 72.9 20.9c2.3-16 8.8-27.1 16-33.7c-55.9-6.2-112.3-14.3-112.3-110.5c0-27.5 7.6-41.3 23.6-58.9c-2.6-6.5-11.1-33.3 2.6-67.9c20.9-6.5 69 27 69 27c20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27c13.7 34.7 5.2 61.4 2.6 67.9c16 17.7 25.8 31.5 25.8 58.9c0 96.5-58.9 104.2-114.8 110.5c9.2 7.9 17 22.9 17 46.4c0 33.7-.3 75.4-.3 83.6c0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252C496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2c1.6 1.6 3.9 2.3 5.2 1c1.3-1 1-3.3-.7-5.2c-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9c1.6 1 3.6.7 4.3-.7c.7-1.3-.3-2.9-2.3-3.9c-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2c2.3 2.3 5.2 2.6 6.5 1c1.3-1.3.7-4.3-1.3-6.2c-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2c-1.4-2.3-4-3.3-5.6-2\"/>",{"left":1514,"top":1514,"width":1519,"height":1519,"rotate":1514,"vFlip":7,"hFlip":7,"body":1520},256,"\u003Cpath fill=\"currentColor\" d=\"M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z\"/>",{}]</script><script>window.__NUXT__={};window.__NUXT__.config={public:{content:{locales:[],defaultLocale:"",integrity:1754354357053,experimental:{stripQueryParameters:false,clientDB:false},api:{baseURL:"/api/_content"},navigation:{fields:["layout"]},tags:{p:"prose-p",a:"prose-a",blockquote:"prose-blockquote","code-inline":"prose-code-inline",code:"prose-code",em:"prose-em",h1:"prose-h1",h2:"prose-h2",h3:"prose-h3",h4:"prose-h4",h5:"prose-h5",h6:"prose-h6",hr:"prose-hr",img:"prose-img",ul:"prose-ul",ol:"prose-ol",li:"prose-li",strong:"prose-strong",table:"prose-table",thead:"prose-thead",tbody:"prose-tbody",td:"prose-td",th:"prose-th",tr:"prose-tr"},highlight:{theme:{dark:"github-dark",default:"github-light"}},wsUrl:"",documentDriven:{page:true,navigation:true,surround:true,globals:{},layoutFallbacks:["theme"],injectPage:true},host:"",trailingSlash:false,anchorLinks:{depth:4,exclude:[1]}},studio:{apiURL:"https://api.nuxt.studio"}},app:{baseURL:"/",buildAssetsDir:"/_nuxt/",cdnURL:""}}</script><script type="module" src="/_nuxt/entry.fbbe5afd.js" crossorigin></script></body>
</html>